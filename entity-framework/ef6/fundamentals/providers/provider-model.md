---
title: Entity Framework 6 sağlayıcı modeli-EF6
author: divega
ms.date: 06/27/2018
ms.assetid: 066832F0-D51B-4655-8BE7-C983C557E0E4
ms.openlocfilehash: 8bda3f51e8934f2add862c30e60f1185f068c515
ms.sourcegitcommit: cc0ff36e46e9ed3527638f7208000e8521faef2e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78419362"
---
# <a name="the-entity-framework-6-provider-model"></a><span data-ttu-id="54b41-102">Entity Framework 6 sağlayıcı modeli</span><span class="sxs-lookup"><span data-stu-id="54b41-102">The Entity Framework 6 provider model</span></span>

<span data-ttu-id="54b41-103">Entity Framework Sağlayıcı modeli, Entity Framework farklı veritabanı sunucusu türleriyle kullanılmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="54b41-103">The Entity Framework provider model allows Entity Framework to be used with different types of database server.</span></span> <span data-ttu-id="54b41-104">Örneğin, bir sağlayıcının Microsoft SQL Server karşı kullanılmasına izin vermek için, başka bir sağlayıcının Microsoft SQL Server Compact sürümünde kullanılmasına izin vermek üzere takılabileceği şekilde erişilebilir olması için bir sağlayıcı takılabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-104">For example, one provider can be plugged in to allow EF to be used against Microsoft SQL Server, while another provider can be plugged into to allow EF to be used against Microsoft SQL Server Compact Edition.</span></span> <span data-ttu-id="54b41-105">Bildiğimiz EF6 sağlayıcıları [Entity Framework sağlayıcılar](~/ef6/fundamentals/providers/index.md) sayfasında bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-105">The providers for EF6 that we are aware of can be found on the [Entity Framework providers](~/ef6/fundamentals/providers/index.md) page.</span></span>

<span data-ttu-id="54b41-106">EF 'in açık kaynaklı bir lisans altında serbest bırakılacağını sağlamak için gerekli olan belirli değişiklikler, aşv ile etkileşime girer.</span><span class="sxs-lookup"><span data-stu-id="54b41-106">Certain changes were required to the way EF interacts with providers to allow EF to be released under an open source license.</span></span> <span data-ttu-id="54b41-107">Bu değişiklikler, sağlayıcının kaydına yönelik yeni mekanizmalarla birlikte EF6 Derlemeleriyle EF sağlayıcılarının yeniden oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-107">These changes require rebuilding of EF providers against the EF6 assemblies together with new mechanisms for registration of the provider.</span></span>

## <a name="rebuilding"></a><span data-ttu-id="54b41-108">Yeniden Oluşturma</span><span class="sxs-lookup"><span data-stu-id="54b41-108">Rebuilding</span></span>

<span data-ttu-id="54b41-109">EF6 ile .NET Framework daha önce bir parçası olan çekirdek kod artık bant dışı (OOB) derlemeler olarak sevk edilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-109">With EF6 the core code that was previously part of the .NET Framework is now being shipped as out-of-band (OOB) assemblies.</span></span> <span data-ttu-id="54b41-110">EF6 'e yönelik uygulamalar oluşturma hakkındaki ayrıntılar, [EF6 için uygulamaları güncelleştirme](~/ef6/what-is-new/upgrading-to-ef6.md) sayfasında bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-110">Details on how to build applications against EF6 can be found on the [Updating applications for EF6](~/ef6/what-is-new/upgrading-to-ef6.md) page.</span></span> <span data-ttu-id="54b41-111">Ayrıca bu yönergeler kullanılarak sağlayıcıların yeniden oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-111">Providers will also need to be rebuilt using these instructions.</span></span>

## <a name="provider-types-overview"></a><span data-ttu-id="54b41-112">Sağlayıcı türlerine genel bakış</span><span class="sxs-lookup"><span data-stu-id="54b41-112">Provider types overview</span></span>

<span data-ttu-id="54b41-113">EF sağlayıcısı gerçekten, bu hizmetlerin genişletecek (bir temel sınıf için) veya uygulama (bir arabirim için) CLR türleri tarafından tanımlanan sağlayıcıya özgü hizmetlerden oluşan bir koleksiyondur.</span><span class="sxs-lookup"><span data-stu-id="54b41-113">An EF provider is really a collection of provider-specific services defined by CLR types that these services extend from (for a base class) or implement (for an interface).</span></span> <span data-ttu-id="54b41-114">Bu hizmetlerden ikisi temel ve EF 'in hiç çalışması için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="54b41-114">Two of these services are fundamental and necessary for EF to function at all.</span></span> <span data-ttu-id="54b41-115">Diğerleri isteğe bağlıdır ve yalnızca belirli işlevler gerekliyse ve/veya hedeflenen belirli veritabanı sunucusu için bu hizmetlerin varsayılan uygulamaları işe gerekmediği takdirde uygulanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-115">Others are optional and only need to be implemented if specific functionality is required and/or the default implementations of these services does not work for the specific database server being targeted.</span></span>

## <a name="fundamental-provider-types"></a><span data-ttu-id="54b41-116">Temel sağlayıcı türleri</span><span class="sxs-lookup"><span data-stu-id="54b41-116">Fundamental provider types</span></span>

### <a name="dbproviderfactory"></a><span data-ttu-id="54b41-117">DbProviderFactory</span><span class="sxs-lookup"><span data-stu-id="54b41-117">DbProviderFactory</span></span>

<span data-ttu-id="54b41-118">EF, tüm düşük düzeydeki veritabanı erişimini gerçekleştirmek için [System. Data. Common. DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) öğesinden türetilmiş bir türe sahip olmaya bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-118">EF depends on having a type derived from [System.Data.Common.DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) for performing all low-level database access.</span></span> <span data-ttu-id="54b41-119">DbProviderFactory gerçekte EF 'in bir parçası değildir ancak bunun yerine, bir sağlayıcının bağımsız olarak bağlantı, komut, parametre ve diğer ADO.NET soyutlamalarını elde etmek için EF, diğer O/RMs tarafından kullanılabilen ADO.NET sağlayıcıları için bir giriş noktasına hizmet veren veya bir uygulama tarafından doğrudan bir uygulama tarafından kullanılan bir .NET Framework sınıf.</span><span class="sxs-lookup"><span data-stu-id="54b41-119">DbProviderFactory is not actually part of EF but is instead a class in the .NET Framework that serves an entry point for ADO.NET providers that can be used by EF, other O/RMs or directly by an application to obtain instances of connections, commands, parameters and other ADO.NET abstractions in a provider agnostic way.</span></span> <span data-ttu-id="54b41-120">DbProviderFactory hakkında daha fazla bilgi [Için MSDN belgelerinde ADO.net](https://msdn.microsoft.com/library/a6cd7c08.aspx)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="54b41-120">More information about DbProviderFactory can be found in the [MSDN documentation for ADO.NET](https://msdn.microsoft.com/library/a6cd7c08.aspx).</span></span>

### <a name="dbproviderservices"></a><span data-ttu-id="54b41-121">DbProviderServices</span><span class="sxs-lookup"><span data-stu-id="54b41-121">DbProviderServices</span></span>

<span data-ttu-id="54b41-122">EF, ADO.NET sağlayıcısı tarafından zaten sağlanan işlevselliğin üzerine gereken ek işlevselliği sağlamak için DbProviderServices 'den türetilmiş bir türe sahip olmaya bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-122">EF depends on having a type derived from DbProviderServices for providing additional functionality needed by EF on top of the functionality already provided by the ADO.NET provider.</span></span> <span data-ttu-id="54b41-123">EF 'in daha eski sürümlerinde DbProviderServices sınıfı .NET Framework bir parçasıdır ve System. Data. Common Ad alanında bulunur.</span><span class="sxs-lookup"><span data-stu-id="54b41-123">In older versions of EF the DbProviderServices class was part of the .NET Framework and was found in the System.Data.Common namespace.</span></span> <span data-ttu-id="54b41-124">EF6 ile başlayarak bu sınıf artık EntityFramework. dll ' nin bir parçasıdır ve System. Data. Entity. Core. Common ad alanıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-124">Starting with EF6 this class is now part of EntityFramework.dll and is in the System.Data.Entity.Core.Common namespace.</span></span>

<span data-ttu-id="54b41-125">DbProviderServices uygulamasının temel işlevleriyle ilgili daha fazla ayrıntı [MSDN](https://msdn.microsoft.com/library/ee789835.aspx)'de bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-125">More details about the fundamental functionality of a DbProviderServices implementation can be found on [MSDN](https://msdn.microsoft.com/library/ee789835.aspx).</span></span> <span data-ttu-id="54b41-126">Ancak, kavramların büyük bir kısmının hala geçerli olmasına rağmen, bu bilgileri yazmanın zaman EF6 için güncellenmediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="54b41-126">However, note that as of the time of writing this information is not updated for EF6 although most of the concepts are still valid.</span></span> <span data-ttu-id="54b41-127">DbProviderServices 'ın SQL Server ve SQL Server Compact uygulamaları da [Açık kaynaklı kod](https://github.com/aspnet/EntityFramework6/) tabanına iade edilir ve diğer uygulamalar için yararlı başvurular olarak hizmet verebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-127">The SQL Server and SQL Server Compact implementations of DbProviderServices are also checked into to the [open-source codebase](https://github.com/aspnet/EntityFramework6/) and can serve as useful references for other implementations.</span></span>

<span data-ttu-id="54b41-128">EF 'in daha eski sürümlerinde kullanılacak DbProviderServices uygulamasının bir ADO.NET sağlayıcısından doğrudan edinildiği.</span><span class="sxs-lookup"><span data-stu-id="54b41-128">In older versions of EF the DbProviderServices implementation to use was obtained directly from an ADO.NET provider.</span></span> <span data-ttu-id="54b41-129">Bu, DbProviderFactory IServiceProvider 'a bağlanarak ve GetService yöntemi çağrılırken yapılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-129">This was done by casting DbProviderFactory to IServiceProvider and calling the GetService method.</span></span> <span data-ttu-id="54b41-130">Bu, EF sağlayıcısını DbProviderFactory 'e sıkı bir şekilde bağlanmış.</span><span class="sxs-lookup"><span data-stu-id="54b41-130">This tightly coupled the EF provider to the DbProviderFactory.</span></span> <span data-ttu-id="54b41-131">Bu bağlantının .NET Framework dışına taşınmasını engelledi ve bu nedenle EF6 bu sıkı bir şekilde kaldırılmıştır ve DbProviderServices 'in bir uygulaması, aşağıdaki _DbProviderServices kaydı_ daha ayrıntılı olarak açıklandığı gibi doğrudan uygulamanın yapılandırma dosyasına veya kod tabanlı yapılandırmada kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-131">This coupling blocked EF from being moved out of the .NET Framework and therefore for EF6 this tight coupling has been removed and an implementation of DbProviderServices is now registered directly in the application’s configuration file or in code-based configuration as described in more detail the _Registering DbProviderServices_ section below.</span></span>

## <a name="additional-services"></a><span data-ttu-id="54b41-132">Ek hizmetler</span><span class="sxs-lookup"><span data-stu-id="54b41-132">Additional services</span></span>

<span data-ttu-id="54b41-133">Yukarıda açıklanan temel hizmetlere ek olarak, EF tarafından her zaman veya bazen sağlayıcıya özgü olan çok sayıda diğer hizmet de mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="54b41-133">In addition to the fundamental services described above there are also many other services used by EF which are either always or sometimes provider-specific.</span></span> <span data-ttu-id="54b41-134">Bu hizmetlerin varsayılan sağlayıcıya özgü uygulamaları, bir DbProviderServices uygulaması tarafından sağlanabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-134">Default provider-specific implementations of these services can be supplied by a DbProviderServices implementation.</span></span> <span data-ttu-id="54b41-135">Uygulamalar Ayrıca bu hizmetlerin uygulamalarını geçersiz kılabilir veya bir DbProviderServices türü için varsayılan değer sağlamadığı durumlarda uygulamalar sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-135">Applications can also override the implementations of these services, or provide implementations when a DbProviderServices type does not provide a default.</span></span> <span data-ttu-id="54b41-136">Bu, aşağıdaki _ek hizmetleri çözme_ bölümünde daha ayrıntılı olarak açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="54b41-136">This is described in more detail in the _Resolving additional services_ section below.</span></span>

<span data-ttu-id="54b41-137">Bir sağlayıcının bir sağlayıcıya ilgi çekici olabileceği ek hizmet türleri aşağıda listelenmiştir.</span><span class="sxs-lookup"><span data-stu-id="54b41-137">The additional service types that a provider may be of interest to a provider are listed below.</span></span> <span data-ttu-id="54b41-138">Bu hizmet türlerinin her biri hakkında daha fazla ayrıntı, API belgelerinde bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-138">More details about each of these service types can be found in the API documentation.</span></span>

### <a name="idbexecutionstrategy"></a><span data-ttu-id="54b41-139">Idbexecutionstrategy</span><span class="sxs-lookup"><span data-stu-id="54b41-139">IDbExecutionStrategy</span></span>

<span data-ttu-id="54b41-140">Bu, bir sağlayıcının sorgular ve komutlar veritabanına göre yürütüldüğünde yeniden denemeler veya diğer davranışları uygulamasına izin veren isteğe bağlı bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="54b41-140">This is an optional service that allows a provider to implement retries or other behavior when queries and commands are executed against the database.</span></span> <span data-ttu-id="54b41-141">Uygulama sağlanmazsa, EF komutları yürütür ve oluşturulan özel durumları yayacaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-141">If no implementation is provided, then EF will simply execute the commands and propagate any exceptions thrown.</span></span> <span data-ttu-id="54b41-142">SQL Server için bu hizmet, SQL Azure gibi bulut tabanlı veritabanı sunucularında çalışırken yararlı olan bir yeniden deneme ilkesi sağlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-142">For SQL Server this service is used to provide a retry policy which is especially useful when running against cloud-based database servers such as SQL Azure.</span></span>

### <a name="idbconnectionfactory"></a><span data-ttu-id="54b41-143">Idbconnectionfactory</span><span class="sxs-lookup"><span data-stu-id="54b41-143">IDbConnectionFactory</span></span>

<span data-ttu-id="54b41-144">Bu, bir sağlayıcının yalnızca bir veritabanı adı verildiğinde bir kurala göre DbConnection nesneleri oluşturmasına olanak sağlayan isteğe bağlı bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="54b41-144">This is an optional service that allows a provider to create DbConnection objects by convention when given only a database name.</span></span> <span data-ttu-id="54b41-145">Bu hizmet bir DbProviderServices uygulamasıyla çözülebildiğinden, EF 4,1 ' den bu yana var olan ve ayrıca yapılandırma dosyasında ya da kodda açıkça ayarlanmış olabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-145">Note that while this service can be resolved by a DbProviderServices implementation it has been present since EF 4.1 and can also be explicitly set in either the config file or in code.</span></span> <span data-ttu-id="54b41-146">Sağlayıcı yalnızca varsayılan sağlayıcı olarak kayıtlıysa (varsayılan _sağlayıcıya_ bakın) ve bir varsayılan bağlantı fabrikası başka bir yerde ayarlanmamışsa bu hizmetin çözümlenme şansı elde eder.</span><span class="sxs-lookup"><span data-stu-id="54b41-146">The provider will only get a chance to resolve this service if it registered as the default provider (see _The default provider_ below) and if a default connection factory has not been set elsewhere.</span></span>

### <a name="dbspatialservices"></a><span data-ttu-id="54b41-147">DbSpatialServices</span><span class="sxs-lookup"><span data-stu-id="54b41-147">DbSpatialServices</span></span>

<span data-ttu-id="54b41-148">Bu, bir sağlayıcının Coğrafya ve geometri uzamsal türler için destek eklemesini sağlayan isteğe bağlı bir hizmetlerdir.</span><span class="sxs-lookup"><span data-stu-id="54b41-148">This is an optional services that allows a provider to add support for geography and geometry spatial types.</span></span> <span data-ttu-id="54b41-149">Bir uygulamanın uzamsal türler içeren EF kullanması için bu hizmetin uygulanması sağlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-149">An implementation of this service must be supplied in order for an application to use EF with spatial types.</span></span> <span data-ttu-id="54b41-150">DbSptialServices için iki şekilde istenir.</span><span class="sxs-lookup"><span data-stu-id="54b41-150">DbSptialServices is asked for in two ways.</span></span> <span data-ttu-id="54b41-151">İlk olarak, sağlayıcıya özgü uzamsal hizmetler, anahtar olarak bir DBProviderInfo nesnesi (Sabit adı ve bildirim belirteci içerir) kullanılarak istenir.</span><span class="sxs-lookup"><span data-stu-id="54b41-151">First, provider-specific spatial services are requested using a DbProviderInfo object (which contains invariant name and manifest token) as key.</span></span> <span data-ttu-id="54b41-152">İkinci olarak, DbSpatialServices hiçbir anahtar olmadan istenebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-152">Second, DbSpatialServices can be asked for with no key.</span></span> <span data-ttu-id="54b41-153">Bu, tek başına Dbcoğrafya veya DbGeometry türleri oluştururken kullanılan "küresel uzamsal sağlayıcıyı" çözümlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-153">This is used to resolve the “global spatial provider” that is used when creating stand-alone DbGeography or DbGeometry types.</span></span>

### <a name="migrationsqlgenerator"></a><span data-ttu-id="54b41-154">MigrationSqlGenerator</span><span class="sxs-lookup"><span data-stu-id="54b41-154">MigrationSqlGenerator</span></span>

<span data-ttu-id="54b41-155">Bu, Code First tarafından veritabanı şemaları oluştururken ve değiştirirken kullanılan SQL üretimi için EF geçişlerinin kullanılmasına izin veren isteğe bağlı bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="54b41-155">This is an optional service that allows EF Migrations to be used for the generation of SQL used in creating and modifying database schemas by Code First.</span></span> <span data-ttu-id="54b41-156">Geçişleri desteklemek için bir uygulama gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-156">An implementation is required in order to support Migrations.</span></span> <span data-ttu-id="54b41-157">Bir uygulama sağlanmışsa, veritabanları veritabanı başlatıcıları veya Database. Create yöntemi kullanılarak oluşturulduğunda de kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-157">If an implementation is provided then it will also be used when databases are created using database initializers or the Database.Create method.</span></span>

### <a name="funcdbconnection-string-historycontextfactory"></a><span data-ttu-id="54b41-158">Func < DbConnection, String, geçmişini contextFactory ></span><span class="sxs-lookup"><span data-stu-id="54b41-158">Func<DbConnection, string, HistoryContextFactory></span></span>

<span data-ttu-id="54b41-159">Bu, bir sağlayıcının,, bir sağlayıcının,,,,, bir sağlayıcının,,,, bir `__MigrationHistory` sağlayıcının, bir sistem.</span><span class="sxs-lookup"><span data-stu-id="54b41-159">This is an optional service that allows a provider to configure the mapping of the HistoryContext to the `__MigrationHistory` table used by EF Migrations.</span></span> <span data-ttu-id="54b41-160">Bu bir DbContext Code First ve tablo adı ve sütun eşleme belirtimleri gibi şeyleri değiştirmek için normal Fluent API kullanılarak yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-160">The HistoryContext is a Code First DbContext and can be configured using the normal fluent API to change things like the name of the table and the column mapping specifications.</span></span> <span data-ttu-id="54b41-161">Tüm varsayılan tablo ve sütun eşlemeleri bu sağlayıcı tarafından destekleniyorsa, tüm sağlayıcılar için EF tarafından döndürülen bu hizmetin varsayılan uygulanması belirli bir veritabanı sunucusu için çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-161">The default implementation of this service returned by EF for all providers may work for a given database server if all the default table and column mappings are supported by that provider.</span></span> <span data-ttu-id="54b41-162">Böyle bir durumda, sağlayıcının bu hizmetin bir uygulamasını sağlaması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="54b41-162">In such a case the provider does not need to supply an implementation of this service.</span></span>

### <a name="idbproviderfactoryresolver"></a><span data-ttu-id="54b41-163">Idbproviderfactoryresolver</span><span class="sxs-lookup"><span data-stu-id="54b41-163">IDbProviderFactoryResolver</span></span>

<span data-ttu-id="54b41-164">Bu, belirli bir DbConnection nesnesinden doğru DbProviderFactory elde etmek için isteğe bağlı bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="54b41-164">This is an optional service for obtaining the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="54b41-165">Tüm sağlayıcılar için EF tarafından döndürülen bu hizmetin varsayılan uygulamasının tüm sağlayıcılar için çalışması amaçlanır.</span><span class="sxs-lookup"><span data-stu-id="54b41-165">The default implementation of this service returned by EF for all providers is intended to work for all providers.</span></span> <span data-ttu-id="54b41-166">Ancak, .NET 4 ' te çalışırken DbProviderFactory, DbConnections ise herkese açık bir şekilde erişemez.</span><span class="sxs-lookup"><span data-stu-id="54b41-166">However, when running on .NET 4, the DbProviderFactory is not publicly accessible from one if its DbConnections.</span></span> <span data-ttu-id="54b41-167">Bu nedenle, EF bir eşleşme bulmak için kayıtlı sağlayıcıları aramak üzere bazı buluşsal yöntemler kullanır.</span><span class="sxs-lookup"><span data-stu-id="54b41-167">Therefore, EF uses some heuristics to search the registered providers to find a match.</span></span> <span data-ttu-id="54b41-168">Bazı sağlayıcılardan bu buluşsal yöntemler başarısız olur ve bu gibi durumlarda sağlayıcı yeni bir uygulama sağlamalıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-168">It is possible that for some providers these heuristics will fail and in such situations the provider should supply a new implementation.</span></span>

## <a name="registering-dbproviderservices"></a><span data-ttu-id="54b41-169">DbProviderServices kaydediliyor</span><span class="sxs-lookup"><span data-stu-id="54b41-169">Registering DbProviderServices</span></span>

<span data-ttu-id="54b41-170">Kullanılacak DbProviderServices uygulaması, uygulamanın yapılandırma dosyasında (App. config veya Web. config) ya da kod tabanlı yapılandırma kullanılarak kaydedilebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-170">The DbProviderServices implementation to use can be registered either in the application’s configuration file (app.config or web.config) or using code-based configuration.</span></span> <span data-ttu-id="54b41-171">Her iki durumda da kayıt, sağlayıcının "sabit adı" nı anahtar olarak kullanır.</span><span class="sxs-lookup"><span data-stu-id="54b41-171">In either case the registration uses the provider’s “invariant name” as a key.</span></span> <span data-ttu-id="54b41-172">Bu, birden çok sağlayıcının tek bir uygulamada kaydedilmesini ve kullanılmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="54b41-172">This allows multiple providers to be registered and used in a single application.</span></span> <span data-ttu-id="54b41-173">EF kayıtları için kullanılan sabit ad, ADO.NET sağlayıcı kaydı ve bağlantı dizeleri için kullanılan sabit adla aynıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-173">The invariant name used for EF registrations is the same as the invariant name used for ADO.NET provider registration and connection strings.</span></span> <span data-ttu-id="54b41-174">Örneğin, SQL Server için "System. Data. SqlClient" sabit adı kullanılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-174">For example, for SQL Server the invariant name “System.Data.SqlClient” is used.</span></span>

### <a name="config-file-registration"></a><span data-ttu-id="54b41-175">Yapılandırma dosyası kaydı</span><span class="sxs-lookup"><span data-stu-id="54b41-175">Config file registration</span></span>

<span data-ttu-id="54b41-176">Kullanılacak DbProviderServices türü, uygulamanın yapılandırma dosyasının entityFramework bölümünün sağlayıcılar listesinde bir sağlayıcı öğesi olarak kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-176">The DbProviderServices type to use is registered as a provider element in the providers list of the entityFramework section of the application’s config file.</span></span> <span data-ttu-id="54b41-177">Örnek:</span><span class="sxs-lookup"><span data-stu-id="54b41-177">For example:</span></span>

``` xml
<entityFramework>
  <providers>
    <provider invariantName="My.Invariant.Name" type="MyProvider.MyProviderServices, MyAssembly" />
  </providers>
</entityFramework>
```

<span data-ttu-id="54b41-178">_Tür_ dizesi, kullanılacak DbProviderServices uygulamasının derleme nitelikli tür adı olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-178">The _type_ string must be the assembly-qualified type name of the DbProviderServices implementation to use.</span></span>

### <a name="code-based-registration"></a><span data-ttu-id="54b41-179">Kod tabanlı kayıt</span><span class="sxs-lookup"><span data-stu-id="54b41-179">Code-based registration</span></span>

<span data-ttu-id="54b41-180">EF6 sağlayıcılardan itibaren, kod kullanılarak da kaydedilebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-180">Starting with EF6 providers can also be registered using code.</span></span> <span data-ttu-id="54b41-181">Bu, bir EF sağlayıcısının uygulamanın yapılandırma dosyasında herhangi bir değişiklik yapılmadan kullanılmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="54b41-181">This allows an EF provider to be used without any change to the application’s configuration file.</span></span> <span data-ttu-id="54b41-182">Kod tabanlı yapılandırmayı kullanmak için bir uygulamanın, [kod tabanlı yapılandırma belgelerinde](https://msdn.com/data/jj680699)açıklandığı gibi bir DBConfiguration sınıfı oluşturması gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-182">To use code-based configuration an application should create a DbConfiguration class as described in the [code-based configuration documentation](https://msdn.com/data/jj680699).</span></span> <span data-ttu-id="54b41-183">DbConfiguration sınıfının Oluşturucusu, EF sağlayıcısını kaydettirmek için SetProviderServices öğesini çağırmalıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-183">The constructor of the DbConfiguration class should then call SetProviderServices to register the EF provider.</span></span> <span data-ttu-id="54b41-184">Örnek:</span><span class="sxs-lookup"><span data-stu-id="54b41-184">For example:</span></span>

``` csharp
public class MyConfiguration : DbConfiguration
{
    public MyConfiguration()
    {
        SetProviderServices("My.New.Provider", new MyProviderServices());
    }
}
```

## <a name="resolving-additional-services"></a><span data-ttu-id="54b41-185">Ek hizmetler çözümleniyor</span><span class="sxs-lookup"><span data-stu-id="54b41-185">Resolving additional services</span></span>

<span data-ttu-id="54b41-186">_Sağlayıcı türlerine genel bakış_ bölümünde belirtildiği gibi, ek hizmetleri çözümlemek için de bir DbProviderServices sınıfı kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-186">As mentioned above in the _Provider types overview_ section, a DbProviderServices class can also be used to resolve additional services.</span></span> <span data-ttu-id="54b41-187">DbProviderServices ıdbdependencyresolver uyguladığından ve kayıtlı her DbProviderServices türü "varsayılan çözümleyici" olarak eklendiğinden, bu mümkündür.</span><span class="sxs-lookup"><span data-stu-id="54b41-187">This is possible because DbProviderServices implements IDbDependencyResolver and each registered DbProviderServices type is added as a “default resolver”.</span></span> <span data-ttu-id="54b41-188">Idbdpendencyresolver mekanizması, [bağımlılık çözümlemesinde](~/ef6/fundamentals/configuring/dependency-resolution.md)daha ayrıntılı olarak açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="54b41-188">The IDbDpendencyResolver mechanism is described in more detail in [Dependency Resolution](~/ef6/fundamentals/configuring/dependency-resolution.md).</span></span> <span data-ttu-id="54b41-189">Ancak, bir sağlayıcıdaki ek hizmetleri çözümlemek için bu belirtideki tüm kavramların anlaşılması gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="54b41-189">However, it is not necessary to understand all the concepts in this specification to resolve additional services in a provider.</span></span>

<span data-ttu-id="54b41-190">Bir sağlayıcının ek hizmetleri çözümlemek için en yaygın yolu, DbProviderServices sınıfının oluşturucusunda her bir hizmet için DbProviderServices. AddDependencyResolver öğesini çağırmaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-190">The most common way for a provider to resolve additional services is to call DbProviderServices.AddDependencyResolver for each service in the constructor of the DbProviderServices class.</span></span> <span data-ttu-id="54b41-191">Örneğin, SqlProviderServices (SQL Server için EF Provider), başlatma için buna benzer bir kod içerir:</span><span class="sxs-lookup"><span data-stu-id="54b41-191">For example, SqlProviderServices (the EF provider for SQL Server) has code similar to this for initialization:</span></span>

``` csharp
private SqlProviderServices()
{
    AddDependencyResolver(new SingletonDependencyResolver<IDbConnectionFactory>(
        new SqlConnectionFactory()));

    AddDependencyResolver(new ExecutionStrategyResolver<DefaultSqlExecutionStrategy>(
        "System.data.SqlClient", null, () => new DefaultSqlExecutionStrategy()));

    AddDependencyResolver(new SingletonDependencyResolver<Func<MigrationSqlGenerator>>(
        () => new SqlServerMigrationSqlGenerator(), "System.data.SqlClient"));

    AddDependencyResolver(new SingletonDependencyResolver<DbSpatialServices>(
        SqlSpatialServices.Instance,
        k =>
        {
            var asSpatialKey = k as DbProviderInfo;
            return asSpatialKey == null
                || asSpatialKey.ProviderInvariantName == ProviderInvariantName;
        }));
}
```

<span data-ttu-id="54b41-192">Bu Oluşturucu aşağıdaki yardımcı sınıfları kullanır:</span><span class="sxs-lookup"><span data-stu-id="54b41-192">This constructor uses the following helper classes:</span></span>

*   <span data-ttu-id="54b41-193">SingletonDependencyResolver: tek Hizmetleri çözümlemek için basit bir yol sağlar — diğer bir deyişle, GetService 'in her çağrılışında aynı örneğin döndürüldüğü hizmetler.</span><span class="sxs-lookup"><span data-stu-id="54b41-193">SingletonDependencyResolver: provides a simple way to resolve Singleton services—that is, services for which the same instance is returned each time that GetService is called.</span></span> <span data-ttu-id="54b41-194">Geçici hizmetler genellikle isteğe bağlı olarak geçici örnekler oluşturmak için kullanılacak tek bir fabrika olarak kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-194">Transient services are often registered as a singleton factory that will be used to create transient instances on demand.</span></span>
*   <span data-ttu-id="54b41-195">Executionstratejik Cayresolver: ıexecutionstrateji uygulamalarının döndürülmesi için özel bir çözümleyici.</span><span class="sxs-lookup"><span data-stu-id="54b41-195">ExecutionStrategyResolver: a resolver specific to returning IExecutionStrategy implementations.</span></span>

<span data-ttu-id="54b41-196">DbProviderServices. AddDependencyResolver kullanmak yerine, DbProviderServices. GetService ' i geçersiz kılmak ve ek hizmetleri doğrudan çözümlemek da mümkündür.</span><span class="sxs-lookup"><span data-stu-id="54b41-196">Instead of using DbProviderServices.AddDependencyResolver it is also possible to override DbProviderServices.GetService and resolve additional services directly.</span></span> <span data-ttu-id="54b41-197">Bu yöntem, EF belirli bir tür tarafından tanımlanan bir hizmete ihtiyaç duyduğunda ve bazı durumlarda belirli bir anahtar için çağrılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-197">This method will be called when EF needs a service defined by a certain type and, in some cases, for a given key.</span></span> <span data-ttu-id="54b41-198">Yöntemi, hizmet tarafından döndürülmeden hizmeti döndürmelidir veya hizmeti döndürmekten vazgeçmek için null döndürebilir ve bunun yerine başka bir sınıfın bunu çözümlemesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="54b41-198">The method should return the service if it can, or return null to opt-out of returning the service and instead allow another class to resolve it.</span></span> <span data-ttu-id="54b41-199">Örneğin, varsayılan bağlantı fabrikasını çözümlemek için GetService 'teki kod şuna benzer görünebilir:</span><span class="sxs-lookup"><span data-stu-id="54b41-199">For example, to resolve the default connection factory the code in GetService might look something like this:</span></span>

``` csharp
public override object GetService(Type type, object key)
{
    if (type == typeof(IDbConnectionFactory))
    {
        return new SqlConnectionFactory();
    }
    return null;
}
```

### <a name="registration-order"></a><span data-ttu-id="54b41-200">Kayıt sırası</span><span class="sxs-lookup"><span data-stu-id="54b41-200">Registration order</span></span>

<span data-ttu-id="54b41-201">Birden çok DbProviderServices uygulaması, bir uygulamanın yapılandırma dosyasına kaydedildiğinde, bunların listelendikleri sırayla ikincil çözümleyiciler olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="54b41-201">When multiple DbProviderServices implementations are registered in an application’s config file they will be added as secondary resolvers in the order that they are listed.</span></span> <span data-ttu-id="54b41-202">Çözümleyiciler her zaman ikincil çözümleyici zincirinin üst kısmına eklendiğinden, bu, listenin sonundaki sağlayıcının diğerlerinden önce bağımlılıkları çözme şansı alabileceği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="54b41-202">Since resolvers are always added to the top of the secondary resolver chain this means that the provider at the end of the list will get a chance to resolve dependencies before the others.</span></span> <span data-ttu-id="54b41-203">(Bu, ilk başta çok az sayıda sayaç görünebilir, ancak her sağlayıcıyı listeden ayırarak ve mevcut sağlayıcıların üzerine yığarak bu durum üzerinde işlem yapar.)</span><span class="sxs-lookup"><span data-stu-id="54b41-203">(This can seem a little counter-intuitive at first, but it makes sense if you imagine taking each provider out of the list and stacking it on top of the existing providers.)</span></span>

<span data-ttu-id="54b41-204">Bu sıralama genellikle çoğu sağlayıcı hizmetinin sağlayıcıya özgü ve sağlayıcı sabit adı tarafından anahtarlamalı olması nedeniyle değildir.</span><span class="sxs-lookup"><span data-stu-id="54b41-204">This ordering usually doesn’t matter because most provider services are provider-specific and keyed by provider invariant name.</span></span> <span data-ttu-id="54b41-205">Ancak, sağlayıcı sabit adına veya sağlayıcıya özgü başka bir anahtara göre anahtarınmayan hizmetler için, hizmet bu sıralamaya göre çözümlenir.</span><span class="sxs-lookup"><span data-stu-id="54b41-205">However, for services that are not keyed by provider invariant name or some other provider-specific key the service will be resolved based on this ordering.</span></span> <span data-ttu-id="54b41-206">Örneğin, başka bir yerde açıkça farklı ayarlanmamışsa, varsayılan bağlantı fabrikası zincirdeki en üstteki sağlayıcıdan gelir.</span><span class="sxs-lookup"><span data-stu-id="54b41-206">For example, if it is not explicitly set differently somewhere else, then the default connection factory will come from the topmost provider in the chain.</span></span>

## <a name="additional-config-file-registrations"></a><span data-ttu-id="54b41-207">Ek yapılandırma dosyası kayıtları</span><span class="sxs-lookup"><span data-stu-id="54b41-207">Additional config file registrations</span></span>

<span data-ttu-id="54b41-208">Yukarıda açıklanan ek sağlayıcı hizmetlerinden bazılarını doğrudan bir uygulamanın yapılandırma dosyasında kaydetmek mümkündür.</span><span class="sxs-lookup"><span data-stu-id="54b41-208">It is possible to explicitly register some of the additional provider services described above directly in an application’s config file.</span></span> <span data-ttu-id="54b41-209">Bu tamamlandığında yapılandırma dosyasındaki kayıt, DbProviderServices uygulamasının GetService yöntemi tarafından döndürülen herhangi bir şey yerine kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-209">When this is done the registration in the config file will be used instead of anything returned by the GetService method of the DbProviderServices implementation.</span></span>

### <a name="registering-the-default-connection-factory"></a><span data-ttu-id="54b41-210">Varsayılan bağlantı fabrikası kaydediliyor</span><span class="sxs-lookup"><span data-stu-id="54b41-210">Registering the default connection factory</span></span>

<span data-ttu-id="54b41-211">EF5 ile başlayarak EntityFramework NuGet paketi otomatik olarak SQL Express bağlantı fabrikası veya yapılandırma dosyasında LocalDb bağlantı fabrikası olarak kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-211">Starting with EF5 the EntityFramework NuGet package automatically registered either the SQL Express connection factory or the LocalDb connection factory in the config file.</span></span>

<span data-ttu-id="54b41-212">Örnek:</span><span class="sxs-lookup"><span data-stu-id="54b41-212">For example:</span></span>

``` xml
<entityFramework>
  <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" >
</entityFramework>
```

<span data-ttu-id="54b41-213">_Tür_ , varsayılan bağlantı fabrikası Için ıdbconnectionfactory uygulaması gereken derleme nitelikli tür adıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-213">The _type_ is the assembly-qualified type name for the default connection factory, which must implement IDbConnectionFactory.</span></span>

<span data-ttu-id="54b41-214">Bir sağlayıcı NuGet paketinin varsayılan bağlantı fabrikası yüklenirken bu şekilde ayarlanması önerilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-214">It is recommended that a provider NuGet package set the default connection factory in this way when installed.</span></span> <span data-ttu-id="54b41-215">Aşağıdaki _sağlayıcılar Için NuGet paketlerine_ bakın.</span><span class="sxs-lookup"><span data-stu-id="54b41-215">See _NuGet Packages for providers_ below.</span></span>

## <a name="additional-ef6-provider-changes"></a><span data-ttu-id="54b41-216">Ek EF6 sağlayıcısı değişiklikleri</span><span class="sxs-lookup"><span data-stu-id="54b41-216">Additional EF6 provider changes</span></span>

### <a name="spatial-provider-changes"></a><span data-ttu-id="54b41-217">Uzamsal sağlayıcı değişiklikleri</span><span class="sxs-lookup"><span data-stu-id="54b41-217">Spatial provider changes</span></span>

<span data-ttu-id="54b41-218">Uzamsal türleri destekleyen sağlayıcılar artık Dbspatıaldatareader ' dan türetilen sınıflarda bazı ek yöntemler gerçekleştirmelidir:</span><span class="sxs-lookup"><span data-stu-id="54b41-218">Providers that support spatial types must now implement some additional methods on classes deriving from DbSpatialDataReader:</span></span>

*   `public abstract bool IsGeographyColumn(int ordinal)`
*   `public abstract bool IsGeometryColumn(int ordinal)`

<span data-ttu-id="54b41-219">Varsayılan uygulamalar, zaman uyumsuz yöntemlere temsilci olarak verilmediğinden geçersiz kılınmasının önerildiği mevcut yöntemlerin yeni zaman uyumsuz sürümleri de vardır ve bu nedenle zaman uyumsuz olarak yürütülmez:</span><span class="sxs-lookup"><span data-stu-id="54b41-219">There are also new asynchronous versions of existing methods that are recommended to be overridden as the default implementations delegate to the synchronous methods and therefore do not execute asynchronously:</span></span>

*   `public virtual Task<DbGeography> GetGeographyAsync(int ordinal, CancellationToken cancellationToken)`
*   `public virtual Task<DbGeometry> GetGeometryAsync(int ordinal, CancellationToken cancellationToken)`

### <a name="native-support-for-enumerablecontains"></a><span data-ttu-id="54b41-220">Sıralanabilir. Contains için yerel destek</span><span class="sxs-lookup"><span data-stu-id="54b41-220">Native support for Enumerable.Contains</span></span>

<span data-ttu-id="54b41-221">EF6, sıralanabilir. LINQ sorgularında bulunan performans sorunlarına yönelik olarak eklenen DbInExpression adlı yeni bir ifade türü sunar.</span><span class="sxs-lookup"><span data-stu-id="54b41-221">EF6 introduces a new expression type, DbInExpression, which was added to address performance issues around use of Enumerable.Contains in LINQ queries.</span></span> <span data-ttu-id="54b41-222">DbProviderManifest sınıfı yeni bir sanal yönteme sahiptir ve bir sağlayıcının yeni ifade türünü işlediğini tespit etmek için EF tarafından çağrılan, SupportsInExpression.</span><span class="sxs-lookup"><span data-stu-id="54b41-222">The DbProviderManifest class has a new virtual method, SupportsInExpression, which is called by EF to determine if a provider handles the new expression type.</span></span> <span data-ttu-id="54b41-223">Mevcut sağlayıcı uygulamalarıyla uyumluluk için, yöntem false döndürür.</span><span class="sxs-lookup"><span data-stu-id="54b41-223">For compatibility with existing provider implementations the method returns false.</span></span> <span data-ttu-id="54b41-224">Bu iyileştirmelerden yararlanmak için, EF6 sağlayıcısı DbInExpression 'ı işlemek üzere kod ekleyebilir ve Supportsınexpression 'ı true döndürecek şekilde geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="54b41-224">To benefit from this improvement, an EF6 provider can add code to handle DbInExpression and override SupportsInExpression to return true.</span></span> <span data-ttu-id="54b41-225">DbInExpression örneği DbExpressionBuilder.In yöntemi çağırarak oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-225">An instance of DbInExpression can be created by calling the DbExpressionBuilder.In method.</span></span> <span data-ttu-id="54b41-226">Bir DbInExpression örneği, genellikle bir tablo sütununu temsil eden bir DbExpression ve bir eşleşme için test edilecek bir DbConstantExpression listesi oluşur.</span><span class="sxs-lookup"><span data-stu-id="54b41-226">A DbInExpression instance is composed of a DbExpression, usually representing a table column, and a list of DbConstantExpression to test for a match.</span></span>

## <a name="nuget-packages-for-providers"></a><span data-ttu-id="54b41-227">Sağlayıcılar için NuGet paketleri</span><span class="sxs-lookup"><span data-stu-id="54b41-227">NuGet packages for providers</span></span>

<span data-ttu-id="54b41-228">EF6 sağlayıcıyı kullanılabilir hale getirmenin bir yolu, bir NuGet paketi olarak yayınlanmanız.</span><span class="sxs-lookup"><span data-stu-id="54b41-228">One way to make an EF6 provider available is to release it as a NuGet package.</span></span> <span data-ttu-id="54b41-229">NuGet paketinin kullanılması aşağıdaki avantajları içerir:</span><span class="sxs-lookup"><span data-stu-id="54b41-229">Using a NuGet package has the following advantages:</span></span>

*   <span data-ttu-id="54b41-230">Sağlayıcının kaydını uygulamanın yapılandırma dosyasına eklemek için NuGet kullanmak kolaydır</span><span class="sxs-lookup"><span data-stu-id="54b41-230">It is easy to use NuGet to add the provider registration to the application’s config file</span></span>
*   <span data-ttu-id="54b41-231">Kural tarafından yapılan bağlantıların kayıtlı sağlayıcıyı kullanması için varsayılan bağlantı fabrikasını ayarlamak üzere yapılandırma dosyasında ek değişiklikler yapılabilir</span><span class="sxs-lookup"><span data-stu-id="54b41-231">Additional changes can be made to the config file to set the default connection factory so that connections made by convention will use the registered provider</span></span>
*   <span data-ttu-id="54b41-232">NuGet, EF6 sağlayıcısı yeni bir EF paketi serbest bırakıldıktan sonra bile çalışmaya devam etmesi için bağlama yeniden yönlendirmeleri eklemeyi işler</span><span class="sxs-lookup"><span data-stu-id="54b41-232">NuGet handles adding binding redirects so that the EF6 provider should continue to work even after a new EF package is released</span></span>

<span data-ttu-id="54b41-233">Bu, [açık kaynak kod](https://github.com/aspnet/entityframework6)tabanına dahil edilen EntityFramework. sqlservercompact Package örneğidir.</span><span class="sxs-lookup"><span data-stu-id="54b41-233">An example of this is the EntityFramework.SqlServerCompact package which is included in the [open source codebase](https://github.com/aspnet/entityframework6).</span></span> <span data-ttu-id="54b41-234">Bu paket, EF sağlayıcısı NuGet paketleri oluşturmak için iyi bir şablon sağlar.</span><span class="sxs-lookup"><span data-stu-id="54b41-234">This package provides a good template for creating EF provider NuGet packages.</span></span>

### <a name="powershell-commands"></a><span data-ttu-id="54b41-235">PowerShell komutları</span><span class="sxs-lookup"><span data-stu-id="54b41-235">PowerShell commands</span></span>

<span data-ttu-id="54b41-236">EntityFramework NuGet paketi yüklendiğinde, sağlayıcı paketleri için çok faydalı olan iki komut içeren bir PowerShell modülü kaydettirir:</span><span class="sxs-lookup"><span data-stu-id="54b41-236">When the EntityFramework NuGet package is installed it registers a PowerShell module that contains two commands that are very useful for provider packages:</span></span>

*   <span data-ttu-id="54b41-237">Add-EFProvider, hedef projenin yapılandırma dosyasında sağlayıcı için yeni bir varlık ekler ve kayıtlı sağlayıcılar listesinin sonunda olduğundan emin olur.</span><span class="sxs-lookup"><span data-stu-id="54b41-237">Add-EFProvider adds a new entity for the provider in the target project’s configuration file and makes sure it is at the end of the list of registered providers.</span></span>
*   <span data-ttu-id="54b41-238">Add-EFDefaultConnectionFactory, hedef projenin yapılandırma dosyasında defaultConnectionFactory kaydını ekler ya da güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="54b41-238">Add-EFDefaultConnectionFactory either adds or updates the defaultConnectionFactory registration in the target project’s configuration file.</span></span>

<span data-ttu-id="54b41-239">Bu komutların her ikisi de bir entityFramework bölümünü yapılandırma dosyasına ekleme ve gerekirse bir sağlayıcı koleksiyonu ekleme işlemini gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="54b41-239">Both these commands take care of adding an entityFramework section to the config file and adding a providers collection if necessary.</span></span>

<span data-ttu-id="54b41-240">Bu komutların install. ps1 NuGet betiğinden çağrılması amaçlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="54b41-240">It is intended that these commands be called from the install.ps1 NuGet script.</span></span> <span data-ttu-id="54b41-241">Örneğin, SQL Compact sağlayıcısı için Install. ps1 şuna benzer:</span><span class="sxs-lookup"><span data-stu-id="54b41-241">For example, install.ps1 for the SQL Compact provider looks similar to this:</span></span>

``` powershell
param($installPath, $toolsPath, $package, $project)
Add-EFDefaultConnectionFactory $project 'System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework' -ConstructorArguments 'System.Data.SqlServerCe.4.0'
Add-EFProvider $project 'System.Data.SqlServerCe.4.0' 'System.Data.Entity.SqlServerCompact.SqlCeProviderServices, EntityFramework.SqlServerCompact'</pre>
```

<span data-ttu-id="54b41-242">Bu komutlar hakkında daha fazla bilgi, Paket Yöneticisi konsol penceresinde Get-Help kullanılarak elde edilebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-242">More information about these commands can be obtained by using get-help in the Package Manager Console window.</span></span>

## <a name="wrapping-providers"></a><span data-ttu-id="54b41-243">Sarmalama sağlayıcıları</span><span class="sxs-lookup"><span data-stu-id="54b41-243">Wrapping providers</span></span>

<span data-ttu-id="54b41-244">Sarmalama sağlayıcısı, var olan bir sağlayıcıyı, profil oluşturma veya izleme yetenekleri gibi diğer işlevlerle genişletmek için sarmalayan bir EF ve/veya ADO.NET sağlayıcısıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-244">A wrapping provider is an EF and/or ADO.NET provider that wraps an existing provider to extend it with other functionality such as profiling or tracing capabilities.</span></span> <span data-ttu-id="54b41-245">Sarmalama sağlayıcıları normal şekilde kaydedilebilir, ancak sağlayıcıya yönelik hizmetlerin çözümlenmesini kesintiye uğratan, sarmalama sağlayıcısının çalışma zamanında kurulması genellikle daha uygundur.</span><span class="sxs-lookup"><span data-stu-id="54b41-245">Wrapping providers can be registered in the normal way, but it is often more convenient to setup the wrapping provider at runtime by intercepting the resolution of provider-related services.</span></span> <span data-ttu-id="54b41-246">DbConfiguration sınıfındaki statik olay OnLockingConfiguration bunu yapmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-246">The static event OnLockingConfiguration on the DbConfiguration class can be used to do this.</span></span>

<span data-ttu-id="54b41-247">EF olduktan sonra OnLockingConfiguration çağrılır ve uygulama etki alanı için tüm EF yapılandırmasının, kullanım için kilitlenmesinden önce nereden elde edildiğimize göre belirlenir.</span><span class="sxs-lookup"><span data-stu-id="54b41-247">OnLockingConfiguration is called after EF has determined where all EF configuration for the app domain will be obtained from but before it is locked for use.</span></span> <span data-ttu-id="54b41-248">Uygulama başlangıcında (EF kullanılmadan önce) uygulamanın bu olay için bir olay işleyicisi kaydetmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-248">At app startup (before EF is used) the app should register an event handler for this event.</span></span> <span data-ttu-id="54b41-249">(Bu işleyiciyi yapılandırma dosyasına kaydetmek için destek eklemeyi düşünüyoruz ancak henüz desteklenmiyor.) Olay işleyicisi daha sonra sarmalanması gereken her hizmet için bir ReplaceService çağrısı yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="54b41-249">(We are considering adding support for registering this handler in the config file but this is not yet supported.) The event handler should then make a call to ReplaceService for every service that needs to be wrapped.</span></span>  

<span data-ttu-id="54b41-250">Örneğin, ıdbconnectionfactory ve DbProviderService 'i kaydırmak için şuna benzer bir işleyici kaydedilmelidir:</span><span class="sxs-lookup"><span data-stu-id="54b41-250">For example, to wrap IDbConnectionFactory and DbProviderService, a handler something like this should be registered:</span></span>

``` csharp
DbConfiguration.OnLockingConfiguration +=
    (_, a) =>
    {
        a.ReplaceService<DbProviderServices>(
            (s, k) => new MyWrappedProviderServices(s));

        a.ReplaceService<IDbConnectionFactory>(
            (s, k) => new MyWrappedConnectionFactory(s));
    };
```

<span data-ttu-id="54b41-251">Çözümlenmiş olan ve artık hizmeti çözümlemek için kullanılan anahtarla birlikte sarmalanmış olan hizmet işleyiciye iletilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-251">The service that has been resolved and should now be wrapped together with the key that was used to resolve the service are passed to the handler.</span></span> <span data-ttu-id="54b41-252">İşleyici daha sonra bu hizmeti sarmalanabilir ve döndürülen hizmeti sarmalanmış sürümle değiştirebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-252">The handler can then wrap this service and replace the returned service with the wrapped version.</span></span>

## <a name="resolving-a-dbproviderfactory-with-ef"></a><span data-ttu-id="54b41-253">Bir DbProviderFactory 'ı EF ile çözme</span><span class="sxs-lookup"><span data-stu-id="54b41-253">Resolving a DbProviderFactory with EF</span></span>

<span data-ttu-id="54b41-254">DbProviderFactory, yukarıdaki _sağlayıcı türleri genel bakış_ bölümünde AÇıKLANDıĞı gibi EF tarafından gereken temel sağlayıcı türlerinden biridir.</span><span class="sxs-lookup"><span data-stu-id="54b41-254">DbProviderFactory is one of the fundamental provider types needed by EF as described in the _Provider types overview_ section above.</span></span> <span data-ttu-id="54b41-255">Zaten belirtildiği gibi, bir EF türü değildir ve kayıt genellikle EF yapılandırmasının bir parçası değildir, ancak bunun yerine Machine. config dosyasında ve/veya uygulamanın yapılandırma dosyasında normal ADO.NET sağlayıcı kaydı olur.</span><span class="sxs-lookup"><span data-stu-id="54b41-255">As already mentioned, It is not an EF type and registration is usually not part of EF configuration, but is instead the normal ADO.NET provider registration in the machine.config file and/or application’s config file.</span></span>

<span data-ttu-id="54b41-256">Bu EF hala, bir DbProviderFactory öğesini kullanmak için ararken normal bağımlılık çözüm mekanizmasını kullanıyor olsa da.</span><span class="sxs-lookup"><span data-stu-id="54b41-256">Despite this EF still uses its normal dependency resolution mechanism when looking for a DbProviderFactory to use.</span></span> <span data-ttu-id="54b41-257">Varsayılan çözümleyici yapılandırma dosyalarında normal ADO.NET kaydını kullanır ve bu nedenle genellikle saydamdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-257">The default resolver uses the normal ADO.NET registration in the config files and so this is usually transparent.</span></span> <span data-ttu-id="54b41-258">Ancak normal bağımlılık çözümleme mekanizması kullanıldığı için, normal ADO.NET kaydı yapılmadığında bile bir ıdbdependencyresolver 'ın bir DbProviderFactory çözümlemek için kullanılabileceği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="54b41-258">But because of the normal dependency resolution mechanism is used it means that an IDbDependencyResolver can be used to resolve a DbProviderFactory even when normal ADO.NET registration has not been done.</span></span>

<span data-ttu-id="54b41-259">DbProviderFactory 'in bu şekilde çözülmesi birçok etkilere sahiptir:</span><span class="sxs-lookup"><span data-stu-id="54b41-259">Resolving DbProviderFactory in this way has several implications:</span></span>

*   <span data-ttu-id="54b41-260">Kod tabanlı yapılandırma kullanan bir uygulama, uygun DbProviderFactory 'yi kaydetmek için DbConfiguration sınıfında çağrı ekleyebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-260">An application using code-based configuration can add calls in their DbConfiguration class to register the appropriate DbProviderFactory.</span></span> <span data-ttu-id="54b41-261">Bu, özellikle herhangi bir dosya tabanlı yapılandırmayı kullanmak istemediğiniz (veya yapamayan) uygulamalar için yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="54b41-261">This is especially useful for applications that do not want to (or cannot) make use of any file-based configuration at all.</span></span>
*   <span data-ttu-id="54b41-262">Bu hizmet, yukarıdaki _sarmalama sağlayıcıları_ bölümünde açıklandığı gibi replaceservice kullanılarak sarmalanabilir veya değiştirilebilir</span><span class="sxs-lookup"><span data-stu-id="54b41-262">The service can be wrapped or replaced using ReplaceService as described in the _Wrapping providers_ section above</span></span>
*   <span data-ttu-id="54b41-263">Teorik olarak, bir DbProviderServices uygulaması bir DbProviderFactory çözümleyebilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-263">Theoretically, a DbProviderServices implementation could resolve a DbProviderFactory.</span></span>

<span data-ttu-id="54b41-264">Bunlardan herhangi birini yapmakla ilgili dikkat edilmesi gereken önemli nokta, yalnızca DbProviderFactory 'ın EF ile olan aramasını etkiler.</span><span class="sxs-lookup"><span data-stu-id="54b41-264">The important point to note about doing any of these things is that they will only affect the lookup of DbProviderFactory by EF.</span></span> <span data-ttu-id="54b41-265">Diğer EF olmayan kod, ADO.NET sağlayıcısı 'nın normal şekilde kaydedilmesini bekleyebilir ve kayıt bulunamazsa başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="54b41-265">Other non-EF code may still expect the ADO.NET provider to be registered in the normal way and may fail if the registration is not found.</span></span> <span data-ttu-id="54b41-266">Bu nedenle, DbProviderFactory 'nin normal ADO.NET şekilde kaydedilmesi genellikle daha iyidir.</span><span class="sxs-lookup"><span data-stu-id="54b41-266">For this reason it is normally better for a DbProviderFactory to be registered in the normal ADO.NET way.</span></span>

### <a name="related-services"></a><span data-ttu-id="54b41-267">İlgili hizmetler</span><span class="sxs-lookup"><span data-stu-id="54b41-267">Related services</span></span>

<span data-ttu-id="54b41-268">Bir DbProviderFactory çözümlemek için EF kullanılırsa, ayrıca IProviderInvariantName ve ıdbproviderfactoryresolver hizmetlerini de çözmelidir.</span><span class="sxs-lookup"><span data-stu-id="54b41-268">If EF is used to resolve a DbProviderFactory, then it should also resolve the IProviderInvariantName and IDbProviderFactoryResolver services.</span></span>

<span data-ttu-id="54b41-269">IProviderInvariantName, belirli bir DbProviderFactory türü için sağlayıcı sabit adını belirlemede kullanılan bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="54b41-269">IProviderInvariantName is a service that is used to determine a provider invariant name for a given type of DbProviderFactory.</span></span> <span data-ttu-id="54b41-270">Bu hizmetin varsayılan uygulanması ADO.NET sağlayıcı kaydını kullanır.</span><span class="sxs-lookup"><span data-stu-id="54b41-270">The default implementation of this service uses the ADO.NET provider registration.</span></span> <span data-ttu-id="54b41-271">Bu, DbProviderFactory EF tarafından çözümlendiği için ADO.NET sağlayıcısı normal şekilde kaydedilmemişse, bu hizmetin çözümlenmesi için de gerekli olacaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-271">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span> <span data-ttu-id="54b41-272">DbConfiguration. SetProviderFactory yöntemi kullanılırken bu hizmet için bir çözümleyici 'nin otomatik olarak eklendiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="54b41-272">Note that a resolver for this service is automatically added when using the DbConfiguration.SetProviderFactory method.</span></span>

<span data-ttu-id="54b41-273">Yukarıdaki _sağlayıcı türleri genel bakış_ bölümünde açıklandığı gibi, ıdbproviderfactoryresolver, belirli bir DbConnection nesnesinden doğru DbProviderFactory elde etmek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="54b41-273">As described in the _Provider types overview_ section above, the IDbProviderFactoryResolver is used to obtain the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="54b41-274">.NET 4 ' te çalışırken bu hizmetin varsayılan uygulanması ADO.NET sağlayıcısı kaydını kullanır.</span><span class="sxs-lookup"><span data-stu-id="54b41-274">The default implementation of this service when running on .NET 4 uses the ADO.NET provider registration.</span></span> <span data-ttu-id="54b41-275">Bu, DbProviderFactory EF tarafından çözümlendiği için ADO.NET sağlayıcısı normal şekilde kaydedilmemişse, bu hizmetin çözümlenmesi için de gerekli olacaktır.</span><span class="sxs-lookup"><span data-stu-id="54b41-275">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span>
