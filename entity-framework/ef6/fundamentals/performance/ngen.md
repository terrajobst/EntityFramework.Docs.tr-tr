---
title: NGen-EF6 ile başlangıç performansını artırma
author: divega
ms.date: 10/23/2016
ms.assetid: dc6110a0-80a0-4370-8190-cea942841cee
ms.openlocfilehash: 841aec645abdb2a56076d0b70bfb2614b0acafb4
ms.sourcegitcommit: 37d0e0fd1703467918665a64837dc54ad2ec7484
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/16/2019
ms.locfileid: "72446002"
---
# <a name="improving-startup-performance-with-ngen"></a><span data-ttu-id="ecf6a-102">NGen ile başlangıç performansını artırma</span><span class="sxs-lookup"><span data-stu-id="ecf6a-102">Improving startup performance with NGen</span></span>
> [!NOTE]
> <span data-ttu-id="ecf6a-103">**Yalnızca EF6** , bu sayfada açıklanan özellikler, API 'ler, vb. Entity Framework 6 ' da sunulmuştur.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-103">**EF6 Onwards Only** - The features, APIs, etc. discussed in this page were introduced in Entity Framework 6.</span></span> <span data-ttu-id="ecf6a-104">Önceki bir sürümü kullanıyorsanız, bilgilerin bazıları veya tümü uygulanmaz.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-104">If you are using an earlier version, some or all of the information does not apply.</span></span>  

<span data-ttu-id="ecf6a-105">.NET Framework, uygulamaların daha hızlı başlamasını ve ayrıca bazı durumlarda daha az bellek kullanmasını sağlamak için yönetilen uygulamalar ve kitaplıklar için yerel görüntülerin oluşturulmasını destekler.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-105">The .NET Framework supports the generation of native images for managed applications and libraries as a way to help applications start faster and also in some cases use less memory.</span></span> <span data-ttu-id="ecf6a-106">Yerel görüntüler, yönetilen kod derlemeleri uygulama yürütülmeden önce yerel makine yönergeleri içeren dosyalara çevrilirken oluşturulur, .NET JıT (tam zamanında) derleyicisini şu adreste yerel yönergeler oluşturmak zorunda kalmadan uygulama çalışma zamanı.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-106">Native images are created by translating managed code assemblies into files containing native machine instructions before the application is executed, relieving the .NET JIT (Just-In-Time) compiler from having to generate the native instructions at application runtime.</span></span>  

<span data-ttu-id="ecf6a-107">Sürüm 6 ' dan önce, EF Runtime 'ın temel kitaplıkları .NET Framework bir parçasıdır ve yerel görüntüler bunlar için otomatik olarak oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-107">Prior to version 6, the EF runtime’s core libraries were part of the .NET Framework and native images were generated automatically for them.</span></span> <span data-ttu-id="ecf6a-108">Sürüm 6 ' dan itibaren, tüm EF çalışma zamanı EntityFramework NuGet paketi ile birleştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-108">Starting with version 6 the whole EF runtime has been combined into the EntityFramework NuGet package.</span></span> <span data-ttu-id="ecf6a-109">Yerel görüntülerin artık benzer sonuçlar elde etmek için NGen. exe komut satırı aracı kullanılarak oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-109">Native images have to now be generated using the NGen.exe command line tool to obtain similar results.</span></span>  

<span data-ttu-id="ecf6a-110">Empırik gözlemleri, EF çalışma zamanı derlemelerinin yerel görüntülerinin, uygulama başlatma süresinin 1 ile 3 saniye arasında kesilmesini olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-110">Empirical observations show that native images of the EF runtime assemblies can cut between 1 and 3 seconds of application startup time.</span></span>  

## <a name="how-to-use-ngenexe"></a><span data-ttu-id="ecf6a-111">NGen. exe kullanma</span><span class="sxs-lookup"><span data-stu-id="ecf6a-111">How to use NGen.exe</span></span>  

<span data-ttu-id="ecf6a-112">NGen. exe aracının en temel işlevi, bir derleme için yerel görüntüleri ve tüm doğrudan bağımlılıklarını "yüklemektir" (diğer bir deyişle, disk oluşturmak ve kalıcı hale getirmek için).</span><span class="sxs-lookup"><span data-stu-id="ecf6a-112">The most basic function of the NGen.exe tool is to “install” (that is, to create and persist to disk) native images for an assembly and all its direct dependencies.</span></span> <span data-ttu-id="ecf6a-113">Şunları elde edebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-113">Here is how you can achieve that:</span></span>  

1. <span data-ttu-id="ecf6a-114">Yönetici olarak bir komut Istemi penceresi açın.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-114">Open a Command Prompt window as an administrator.</span></span>
2. <span data-ttu-id="ecf6a-115">Geçerli çalışma dizinini yerel görüntü oluşturmak istediğiniz derlemelerin konumuyla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-115">Change the current working directory to the location of the assemblies you want to generate native images for:</span></span>

   ``` console
   cd <*Assemblies location*>  
   ```

3. <span data-ttu-id="ecf6a-116">İşletim sisteminize ve uygulamanın yapılandırmasına bağlı olarak, 32 bit mimarisi, 64 bit mimarisi veya her ikisi için de yerel görüntüler oluşturmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-116">Depending on your operating system and the application’s configuration you might need to generate native images for 32 bit architecture, 64 bit architecture or for both.</span></span>

   <span data-ttu-id="ecf6a-117">32 bit çalıştırması için:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-117">For 32 bit run:</span></span>

   ``` console
   %WINDIR%\Microsoft.NET\Framework\v4.0.30319\ngen install <Assembly name>  
   ```

   <span data-ttu-id="ecf6a-118">64 bit çalıştırması için:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-118">For 64 bit run:</span></span>
  
   ``` console
   %WINDIR%\Microsoft.NET\Framework64\v4.0.30319\ngen install <Assembly name>  
   ```

> [!TIP]
> <span data-ttu-id="ecf6a-119">Yanlış mimari için yerel görüntülerin oluşturulması çok yaygın bir hata oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-119">Generating native images for the wrong architecture is a very common mistake.</span></span> <span data-ttu-id="ecf6a-120">Şüpheli durumda, makinede yüklü olan işletim sistemi için uygulanan tüm mimarilerin yerel görüntülerini oluşturmanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-120">When in doubt you can simply generate native images for all the architectures that apply to the operating system installed in the machine.</span></span>  

<span data-ttu-id="ecf6a-121">NGen. exe, yüklü yerel görüntüleri kaldırma ve görüntüleme, birden çok görüntünün oluşturulmasını sıraya alma, vb. gibi işlevleri de destekler. Kullanım hakkında daha fazla bilgi için [Ngen. exe belgelerini](https://msdn.microsoft.com/library/6t9t5wcf.aspx)okuyun.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-121">NGen.exe also supports other functions such as uninstalling and displaying the installed native images, queuing the generation of multiple images, etc. For more details of usage read the [NGen.exe documentation](https://msdn.microsoft.com/library/6t9t5wcf.aspx).</span></span>  

## <a name="when-to-use-ngenexe"></a><span data-ttu-id="ecf6a-122">NGen. exe ne zaman kullanılır?</span><span class="sxs-lookup"><span data-stu-id="ecf6a-122">When to use NGen.exe</span></span>  

<span data-ttu-id="ecf6a-123">Bir uygulama için, EF sürüm 6 veya üzerini temel alan bir uygulamada yerel görüntü oluşturmak üzere hangi derlemeler olduğuna karar verirken, aşağıdaki seçenekleri göz önünde bulundurmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-123">When it comes to decide which assemblies to generate native images for in an application based on EF version 6 or greater, you should consider the following options:</span></span>  

- <span data-ttu-id="ecf6a-124">**Ana EF çalışma zamanı derlemesi, EntityFramework. dll**: tıpık bir EF tabanlı uygulama, başlangıçta bu derlemeden veya veritabanına ilk erişimi üzerinde önemli miktarda kod yürütür.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-124">**The main EF runtime assembly, EntityFramework.dll**: A typical EF based application executes a significant amount of code from this assembly on startup or on its first access to the database.</span></span> <span data-ttu-id="ecf6a-125">Sonuç olarak, bu derlemenin yerel görüntülerini oluşturmak, başlangıç performansındaki en büyük kazancı oluşturacaktır.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-125">Consequently, creating native images of this assembly will produce the biggest gains in startup performance.</span></span>  
- <span data-ttu-id="ecf6a-126">**Uygulamanız tarafından kullanılan herhangi BIR EF sağlayıcı derlemesi**: başlangıç saati, bunların yerel görüntülerini oluşturmaktan biraz daha da yararlanabilir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-126">**Any EF provider assembly used by your application**: Startup time can also benefit slightly from generating native images of these.</span></span> <span data-ttu-id="ecf6a-127">Örneğin, uygulama SQL Server için EF sağlayıcısını kullanıyorsa, EntityFramework. SqlServer. dll için yerel bir görüntü oluşturmak isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-127">For example, if the application uses the EF provider for SQL Server you will want to generate a native image for EntityFramework.SqlServer.dll.</span></span>  
- <span data-ttu-id="ecf6a-128">**Uygulamanızın derlemeleri ve diğer bağımlılıkları**: [Ngen. exe belgeleri](https://msdn.microsoft.com/library/6t9t5wcf.aspx) , yerel görüntüler için hangi derlemelerin oluşturulacağını ve yerel görüntülerin güvenlik üzerindeki etkisini ve "Hard" gibi gelişmiş seçenekleri bağlama ", hata ayıklama ve profil oluşturma senaryolarında yerel görüntüleri kullanma gibi senaryolar, vb.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-128">**Your application’s assemblies and other dependencies**: The [NGen.exe documentation](https://msdn.microsoft.com/library/6t9t5wcf.aspx) covers general criteria for choosing which assemblies to generate native images for and the impact of native images on security, advanced options such as “hard binding”, scenarios such as using native images in debugging and profiling scenarios, etc.</span></span>  

> [!TIP]
> <span data-ttu-id="ecf6a-129">Yerel görüntülerin hem başlangıç performansı hem de uygulamanızın genel performansı ve gerçek gereksinimlere göre karşılaştırıldığı etkileri dikkatle ölçdiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-129">Make sure you carefully measure the impact of using native images on both the startup performance and the overall performance of your application and compare them against actual requirements.</span></span> <span data-ttu-id="ecf6a-130">Yerel görüntüler genellikle başlangıçtaki performansı artırmaya yardımcı olur ve bazı durumlarda bellek kullanımını azaltırken, tüm senaryolar eşit olarak avantajına sahip olur.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-130">While native images will generally help improve startup up performance and in some cases reduce memory usage, not all scenarios will benefit equally.</span></span> <span data-ttu-id="ecf6a-131">Örneğin, kararlı durum yürütmesinde (yani, uygulama tarafından kullanılan tüm yöntemler en az bir kez çağrıldığında), JıT derleyicisi tarafından oluşturulan kod aslında yerel görüntülerden biraz daha iyi performans sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-131">For instance, on steady state execution (that is, once all the methods being used by the application have been invoked at least once) code generated by the JIT compiler can in fact yield slightly better performance than native images.</span></span>  

## <a name="using-ngenexe-in-a-development-machine"></a><span data-ttu-id="ecf6a-132">Bir geliştirme makinesinde NGen. exe kullanma</span><span class="sxs-lookup"><span data-stu-id="ecf6a-132">Using NGen.exe in a development machine</span></span>  

<span data-ttu-id="ecf6a-133">Geliştirme sırasında .NET JıT derleyicisi, sık değişen kod için en iyi genel zorunluluğunu getirir sunar.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-133">During development the .NET JIT compiler will offer the best overall tradeoff for code that is changing frequently.</span></span> <span data-ttu-id="ecf6a-134">EF çalışma zamanı derlemeleri gibi derlenmiş bağımlılıklar için yerel görüntülerin oluşturulması, her yürütmenin başlangıcında birkaç saniyelik bir süreyi izleyerek geliştirme ve test sürecini hızlandırmaya yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-134">Generating native images for compiled dependencies such as the EF runtime assemblies can help accelerate development and testing by cutting a few seconds out at the beginning of each execution.</span></span>  

<span data-ttu-id="ecf6a-135">EF çalışma zamanı derlemelerini bulmak için iyi bir yer vardır.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-135">A good place to find the EF runtime assemblies is the NuGet package location for the solution.</span></span> <span data-ttu-id="ecf6a-136">Örneğin, SQL Server ile EF 6.0.2 kullanan bir uygulama için, .NET 4,5 veya üstünü hedeflemek için bir komut Istemi penceresine (yönetici olarak açmayı unutmayın) şunu yazabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="ecf6a-136">For example, for an application using EF 6.0.2 with SQL Server and targeting .NET 4.5 or greater you can type the following in a Command Prompt window (remember to open it as an administrator):</span></span>  

```console
cd <Solution directory>\packages\EntityFramework.6.0.2\lib\net45
%WINDIR%\Microsoft.NET\Framework\v4.0.30319\ngen install EntityFramework.SqlServer.dll
%WINDIR%\Microsoft.NET\Framework64\v4.0.30319\ngen install EntityFramework.SqlServer.dll
```  

> [!NOTE]
> <span data-ttu-id="ecf6a-137">Bu, SQL Server için doğal sağlayıcının yerel görüntülerini yüklemenin yanı sıra, ana EF çalışma zamanı derlemesinin yerel görüntülerini da yükler.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-137">This takes advantage of the fact that installing the native images for EF provider for SQL Server will also by default install the native images for the main EF runtime assembly.</span></span> <span data-ttu-id="ecf6a-138">Bu, NGen. exe ' nin EntityFramework. dll ' nin aynı dizinde bulunan EntityFramework. SqlServer. dll derlemesinin doğrudan bağımlılığı algılayabileceğinden, bu işe yarar.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-138">This works because NGen.exe can detect that EntityFramework.dll is a direct dependency of the EntityFramework.SqlServer.dll assembly located in the same directory.</span></span>  

## <a name="creating-native-images-during-setup"></a><span data-ttu-id="ecf6a-139">Kurulum sırasında yerel görüntüler oluşturma</span><span class="sxs-lookup"><span data-stu-id="ecf6a-139">Creating native images during setup</span></span>  

<span data-ttu-id="ecf6a-140">WiX araç seti, bu [nasıl yapılır kılavuzunda](https://wixtoolset.org/documentation/manual/v3/howtos/files_and_registry/ngen_managed_assemblies.html)açıklandığı gibi, kurulum sırasında yönetilen derlemeler için yerel görüntülerin oluşturulmasını sıraya almayı destekler.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-140">The WiX Toolkit supports queuing the generation of native images for managed assemblies during setup, as explained in this [how-to guide](https://wixtoolset.org/documentation/manual/v3/howtos/files_and_registry/ngen_managed_assemblies.html).</span></span> <span data-ttu-id="ecf6a-141">Diğer bir seçenek de NGen. exe komutunu yürütecek özel bir kurulum görevi oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-141">Another alternative is to create a custom setup task that execute the NGen.exe command.</span></span>  

## <a name="verifying-that-native-images-are-being-used-for-ef"></a><span data-ttu-id="ecf6a-142">Yerel görüntülerin EF için kullanıldığı doğrulanıyor</span><span class="sxs-lookup"><span data-stu-id="ecf6a-142">Verifying that native images are being used for EF</span></span>  

<span data-ttu-id="ecf6a-143">Belirli bir uygulamanın, ". nı. dll" veya ". nı. exe" uzantısına sahip yüklü derlemeleri arayarak yerel bir derlemeyi kullandığını doğrulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-143">You can verify that a specific application is using a native assembly by looking for loaded assemblies that have the extension “.ni.dll” or “.ni.exe”.</span></span> <span data-ttu-id="ecf6a-144">Örneğin, EF 'in ana çalışma zamanı derlemesi için yerel bir görüntü EntityFramework. nı. dll olarak adlandırılacaktır.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-144">For example, a native image for the EF’s main runtime assembly will be called EntityFramework.ni.dll.</span></span> <span data-ttu-id="ecf6a-145">Bir işlemin yüklü .NET derlemelerini incelemenize yönelik kolay bir yol, [Işlem Gezginini](https://technet.microsoft.com/sysinternals/bb896653)kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-145">An easy way to inspect the loaded .NET assemblies of a process is to use [Process Explorer](https://technet.microsoft.com/sysinternals/bb896653).</span></span>  

## <a name="other-things-to-be-aware-of"></a><span data-ttu-id="ecf6a-146">Bilmeniz gerekenler</span><span class="sxs-lookup"><span data-stu-id="ecf6a-146">Other things to be aware of</span></span>  

<span data-ttu-id="ecf6a-147">Bütünleştirilmiş **kodun yerel görüntüsünü oluşturmak, derlemeyi [GAC 'de (genel derleme önbelleği)](https://msdn.microsoft.com/library/yf1d93sz.aspx)kaydederek karıştırılmamalıdır**.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-147">**Creating a native image of an assembly should not be confused with registering the assembly in the [GAC (Global Assembly Cache)](https://msdn.microsoft.com/library/yf1d93sz.aspx)**.</span></span> <span data-ttu-id="ecf6a-148">NGen. exe GAC içinde olmayan derlemelerin görüntülerini oluşturmaya izin verir ve aslında belirli bir EF sürümü kullanan birden çok uygulama aynı yerel görüntüyü paylaşabilir.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-148">NGen.exe allows creating images of assemblies that are not in the GAC, and in fact, multiple applications that use a specific version of EF can share the same native image.</span></span> <span data-ttu-id="ecf6a-149">Windows 8 GAC 'ye yerleştirilmiş derlemeler için otomatik olarak yerel görüntüler oluşturmasının yanı sıra, EF çalışma zamanının uygulamanız ile birlikte dağıtılması en iyi duruma getirilmiştir ve bu, derleme çözümlemesi üzerinde olumsuz bir etkiye sahip olduğundan GAC 'ye kaydolmasını önermiyoruz. diğer yönleri arasında uygulamalarınıza bakım yapma.</span><span class="sxs-lookup"><span data-stu-id="ecf6a-149">While Windows 8 can automatically create native images for assemblies placed in the GAC, the EF runtime is optimized to be deployed alongside your application and we do not recommend registering it in the GAC as this has a negative impact on assembly resolution and servicing your applications among other aspects.</span></span>  
