---
title: Önceki sürümlerden EF Core 2 ' ye yükseltme-EF Core
author: divega
ms.date: 08/13/2017
ms.assetid: 8BD43C8C-63D9-4F3A-B954-7BC518A1B7DB
uid: core/miscellaneous/1x-2x-upgrade
ms.openlocfilehash: 42e59b47f569ef6fcf72fc5bd5f94d3e9d807a24
ms.sourcegitcommit: 6c28926a1e35e392b198a8729fc13c1c1968a27b
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/02/2019
ms.locfileid: "71813567"
---
# <a name="upgrading-applications-from-previous-versions-to-ef-core-20"></a><span data-ttu-id="a1e95-102">Önceki sürümlerden uygulamaları EF Core 2,0 ' ye yükseltme</span><span class="sxs-lookup"><span data-stu-id="a1e95-102">Upgrading applications from previous versions to EF Core 2.0</span></span>

<span data-ttu-id="a1e95-103">2,0 ' de var olan API 'Leri ve davranışları önemli ölçüde geliştirmeye yönelik fırsat aldık.</span><span class="sxs-lookup"><span data-stu-id="a1e95-103">We have taken the opportunity to significantly refine our existing APIs and behaviors in 2.0.</span></span> <span data-ttu-id="a1e95-104">Mevcut uygulama kodu üzerinde değişiklik yapılmasını gerektirebilecek birkaç iyileştirme vardır; ancak, uygulamanın büyük bir bölümü için en düşük durumda, yalnızca yeniden derleme ve kullanılmayan API 'Leri değiştirmek için en düşük düzeyde yapılan değişiklikler gerekir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-104">There are a few improvements that can require modifying existing application code, although we believe that for the majority of applications the impact will be low, in most cases requiring just recompilation and minimal guided changes to replace obsolete APIs.</span></span>

<span data-ttu-id="a1e95-105">Mevcut bir uygulamayı EF Core 2,0 ' ye güncelleştirme şunları gerektirebilir:</span><span class="sxs-lookup"><span data-stu-id="a1e95-105">Updating an existing application to EF Core 2.0 may require:</span></span>

1. <span data-ttu-id="a1e95-106">Uygulamanın hedef .NET uygulamasını .NET Standard 2,0 ' i destekleyen bir sürümüne yükseltme.</span><span class="sxs-lookup"><span data-stu-id="a1e95-106">Upgrading the target .NET implementation of the application to one that supports .NET Standard 2.0.</span></span> <span data-ttu-id="a1e95-107">Daha fazla bilgi için bkz. [desteklenen .NET uygulamaları](../platforms/index.md) .</span><span class="sxs-lookup"><span data-stu-id="a1e95-107">See [Supported .NET Implementations](../platforms/index.md) for more details.</span></span>

2. <span data-ttu-id="a1e95-108">Hedef veritabanı için EF Core 2,0 ile uyumlu bir sağlayıcı belirler.</span><span class="sxs-lookup"><span data-stu-id="a1e95-108">Identify a provider for the target database which is compatible with EF Core 2.0.</span></span> <span data-ttu-id="a1e95-109">Bkz. [EF Core 2,0, aşağıda 2,0 veritabanı sağlayıcısı gerektirir](#ef-core-20-requires-a-20-database-provider) .</span><span class="sxs-lookup"><span data-stu-id="a1e95-109">See [EF Core 2.0 requires a 2.0 database provider](#ef-core-20-requires-a-20-database-provider) below.</span></span>

3. <span data-ttu-id="a1e95-110">Tüm EF Core paketlerini (çalışma zamanı ve araçları) 2,0 ' ye yükseltme.</span><span class="sxs-lookup"><span data-stu-id="a1e95-110">Upgrading all the EF Core packages (runtime and tooling) to 2.0.</span></span> <span data-ttu-id="a1e95-111">Daha fazla ayrıntı için [EF Core yükleme](../get-started/install/index.md) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="a1e95-111">Refer to [Installing EF Core](../get-started/install/index.md) for more details.</span></span>

4. <span data-ttu-id="a1e95-112">Bu belgenin geri kalanında açıklanan son değişiklikleri dengelemek için gerekli kod değişikliklerini yapın.</span><span class="sxs-lookup"><span data-stu-id="a1e95-112">Make any necessary code changes to compensate for the breaking changes described in the rest of this document.</span></span>

## <a name="aspnet-core-now-includes-ef-core"></a><span data-ttu-id="a1e95-113">ASP.NET Core artık EF Core içeriyor</span><span class="sxs-lookup"><span data-stu-id="a1e95-113">ASP.NET Core now includes EF Core</span></span>

<span data-ttu-id="a1e95-114">ASP.NET Core 2,0 ' i hedefleyen uygulamalar, EF Core 2,0 ' i üçüncü taraf veritabanı sağlayıcılarının yanında ek bağımlılıklar olmadan kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-114">Applications targeting ASP.NET Core 2.0 can use EF Core 2.0 without additional dependencies besides third party database providers.</span></span> <span data-ttu-id="a1e95-115">Ancak, önceki ASP.NET Core sürümlerinin hedeflediği uygulamaların EF Core 2,0 ' i kullanabilmesi için ASP.NET Core 2,0 ' e yükseltilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-115">However, applications targeting previous versions of ASP.NET Core need to upgrade to ASP.NET Core 2.0 in order to use EF Core 2.0.</span></span> <span data-ttu-id="a1e95-116">ASP.NET Core Uygulamaları 2,0 ' ye yükseltme hakkında daha fazla ayrıntı için [, konusunun ASP.NET Core belgelerine](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/)bakın.</span><span class="sxs-lookup"><span data-stu-id="a1e95-116">For more details on upgrading ASP.NET Core applications to 2.0 see [the ASP.NET Core documentation on the subject](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span></span>

## <a name="new-way-of-getting-application-services-in-aspnet-core"></a><span data-ttu-id="a1e95-117">Uygulama hizmetlerini ASP.NET Core almanın yeni yolu</span><span class="sxs-lookup"><span data-stu-id="a1e95-117">New way of getting application services in ASP.NET Core</span></span>

<span data-ttu-id="a1e95-118">ASP.NET Core Web uygulamaları için önerilen model, 1. x içinde kullanılan tasarım zamanı mantığını EF Core bir şekilde 2,0 için güncelleştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-118">The recommended pattern for ASP.NET Core web applications has been updated for 2.0 in a way that broke the design-time logic EF Core used in 1.x.</span></span> <span data-ttu-id="a1e95-119">Daha önce tasarım zamanında EF Core, uygulamanın hizmet sağlayıcısına erişmek için `Startup.ConfigureServices` doğrudan çağırmayı deneyebilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-119">Previously at design-time, EF Core would try to invoke `Startup.ConfigureServices` directly in order to access the application's service provider.</span></span> <span data-ttu-id="a1e95-120">ASP.NET Core 2,0 ' de, yapılandırma `Startup` sınıfının dışında başlatılır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-120">In ASP.NET Core 2.0, Configuration is initialized outside of the `Startup` class.</span></span> <span data-ttu-id="a1e95-121">EF Core kullanan uygulamalar genellikle bağlantı dizesine, bu nedenle `Startup` kendisi artık yeterli olmaz.</span><span class="sxs-lookup"><span data-stu-id="a1e95-121">Applications using EF Core typically access their connection string from Configuration, so `Startup` by itself is no longer sufficient.</span></span> <span data-ttu-id="a1e95-122">Bir ASP.NET Core 1. x uygulamasını yükseltirseniz EF Core araçlarını kullanırken aşağıdaki hatayı alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a1e95-122">If you upgrade an ASP.NET Core 1.x application, you may receive the following error when using the EF Core tools.</span></span>

> <span data-ttu-id="a1e95-123">' ApplicationContext ' üzerinde parametresiz oluşturucu bulunamadı.</span><span class="sxs-lookup"><span data-stu-id="a1e95-123">No parameterless constructor was found on 'ApplicationContext'.</span></span> <span data-ttu-id="a1e95-124">' ApplicationContext ' öğesine parametresiz bir Oluşturucu ekleyin ya da ' ApplicationContext ' ile aynı derlemede ' ıdesigntimedbcontextfactory&lt;ApplicationContext&gt;' uygulamasını ekleyin</span><span class="sxs-lookup"><span data-stu-id="a1e95-124">Either add a parameterless constructor to 'ApplicationContext' or add an implementation of 'IDesignTimeDbContextFactory&lt;ApplicationContext&gt;' in the same assembly as 'ApplicationContext'</span></span>

<span data-ttu-id="a1e95-125">ASP.NET Core 2.0 'ın varsayılan şablonuna yeni bir tasarım zamanı kancası eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-125">A new design-time hook has been added in ASP.NET Core 2.0's default template.</span></span> <span data-ttu-id="a1e95-126">Statik `Program.BuildWebHost` Yöntem EF Core, tasarım zamanında uygulamanın hizmet sağlayıcısına erişmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="a1e95-126">The static `Program.BuildWebHost` method enables EF Core to access the application's service provider at design time.</span></span> <span data-ttu-id="a1e95-127">Bir ASP.NET Core 1. x uygulamasını yükseltiyorsanız, `Program` sınıfı aşağıdakine benzeyecek şekilde güncelleştirmeniz gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-127">If you are upgrading an ASP.NET Core 1.x application, you will need to update the `Program` class to resemble the following.</span></span>

``` csharp
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;

namespace AspNetCoreDotNetCore2._0App
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =>
            WebHost.CreateDefaultBuilder(args)
                .UseStartup<Startup>()
                .Build();
    }
}
```

<span data-ttu-id="a1e95-128">Uygulamaları 2,0 ' e güncelleştirirken bu yeni düzeni benimseme işlemi, Entity Framework Core geçişlerinin çalışması gibi ürün özelliklerinin olması için gereklidir ve gereklidir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-128">The adoption of this new pattern when updating applications to 2.0 is highly recommended and is required in order for product features like Entity Framework Core Migrations to work.</span></span> <span data-ttu-id="a1e95-129">Diğer yaygın alternatif, [ *\<ıdesigntimedbcontextfactory tcontext >* ](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory)uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-129">The other common alternative is to [implement *IDesignTimeDbContextFactory\<TContext>*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span></span>

## <a name="idbcontextfactory-renamed"></a><span data-ttu-id="a1e95-130">Idbcontextfactory yeniden adlandırıldı</span><span class="sxs-lookup"><span data-stu-id="a1e95-130">IDbContextFactory renamed</span></span>

<span data-ttu-id="a1e95-131">Farklı uygulama düzenlerini desteklemek ve kullanıcılara tasarım zamanında nasıl kullanıldıkları hakkında `DbContext` daha fazla denetim sağlamak için, daha önce `IDbContextFactory<TContext>` arabirimi sağladık.</span><span class="sxs-lookup"><span data-stu-id="a1e95-131">In order to support diverse application patterns and give users more control over how their `DbContext` is used at design time, we have, in the past, provided the `IDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="a1e95-132">Tasarım zamanında EF Core araçları projenizdeki bu arabirimin uygulamalarını bulacak ve nesne oluşturmak `DbContext` için kullanacaktır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-132">At design-time, the EF Core tools will discover implementations of this interface in your project and use it to create `DbContext` objects.</span></span>

<span data-ttu-id="a1e95-133">Bu arabirimin çok genel bir adı vardı, bu da bazı kullanıcıların diğer `DbContext`oluşturma senaryolarında yeniden kullanılmasını denemeye neden olur.</span><span class="sxs-lookup"><span data-stu-id="a1e95-133">This interface had a very general name which mislead some users to try re-using it for other `DbContext`-creating scenarios.</span></span> <span data-ttu-id="a1e95-134">EF araçları, daha sonra kendi uygulamasını tasarım zamanında kullanmaya çalıştık ve `Update-Database` veya `dotnet ef database update` başarısız olan komutlara neden olan komutları koruma dışı bırakır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-134">They were caught off guard when the EF Tools then tried to use their implementation at design-time and caused commands like `Update-Database` or `dotnet ef database update` to fail.</span></span>

<span data-ttu-id="a1e95-135">Bu arabirimin güçlü tasarım zamanı semantiğini iletmek için bunu olarak `IDesignTimeDbContextFactory<TContext>`yeniden adlandırdık.</span><span class="sxs-lookup"><span data-stu-id="a1e95-135">In order to communicate the strong design-time semantics of this interface, we have renamed it to `IDesignTimeDbContextFactory<TContext>`.</span></span>

<span data-ttu-id="a1e95-136">2,0 sürümü için hala var `IDbContextFactory<TContext>` , ancak eski olarak işaretlendi.</span><span class="sxs-lookup"><span data-stu-id="a1e95-136">For the 2.0 release the `IDbContextFactory<TContext>` still exists but is marked as obsolete.</span></span>

## <a name="dbcontextfactoryoptions-removed"></a><span data-ttu-id="a1e95-137">DbContextFactoryOptions kaldırıldı</span><span class="sxs-lookup"><span data-stu-id="a1e95-137">DbContextFactoryOptions removed</span></span>

<span data-ttu-id="a1e95-138">Yukarıda açıklanan ASP.NET Core 2,0 değişikliği nedeniyle, yeni `DbContextFactoryOptions` `IDesignTimeDbContextFactory<TContext>` arabirimde artık gerekli olmadığını bulduk.</span><span class="sxs-lookup"><span data-stu-id="a1e95-138">Because of the ASP.NET Core 2.0 changes described above, we found that `DbContextFactoryOptions` was no longer needed on the new `IDesignTimeDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="a1e95-139">Bunun yerine kullanmanız gereken alternatifler aşağıda verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-139">Here are the alternatives you should be using instead.</span></span>

| <span data-ttu-id="a1e95-140">DbContextFactoryOptions</span><span class="sxs-lookup"><span data-stu-id="a1e95-140">DbContextFactoryOptions</span></span> | <span data-ttu-id="a1e95-141">Yapıyı</span><span class="sxs-lookup"><span data-stu-id="a1e95-141">Alternative</span></span>                                                  |
|:------------------------|:-------------------------------------------------------------|
| <span data-ttu-id="a1e95-142">ApplicationBasePath</span><span class="sxs-lookup"><span data-stu-id="a1e95-142">ApplicationBasePath</span></span>     | <span data-ttu-id="a1e95-143">AppContext. BaseDirectory</span><span class="sxs-lookup"><span data-stu-id="a1e95-143">AppContext.BaseDirectory</span></span>                                     |
| <span data-ttu-id="a1e95-144">ContentRootPath</span><span class="sxs-lookup"><span data-stu-id="a1e95-144">ContentRootPath</span></span>         | <span data-ttu-id="a1e95-145">Directory.GetCurrentDirectory()</span><span class="sxs-lookup"><span data-stu-id="a1e95-145">Directory.GetCurrentDirectory()</span></span>                              |
| <span data-ttu-id="a1e95-146">EnvironmentName</span><span class="sxs-lookup"><span data-stu-id="a1e95-146">EnvironmentName</span></span>         | <span data-ttu-id="a1e95-147">Environment. GetEnvironmentVariable ("ASPNETCORE_ENVIRONMENT")</span><span class="sxs-lookup"><span data-stu-id="a1e95-147">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span></span> |

## <a name="design-time-working-directory-changed"></a><span data-ttu-id="a1e95-148">Tasarım zamanı çalışma dizini değişti</span><span class="sxs-lookup"><span data-stu-id="a1e95-148">Design-time working directory changed</span></span>

<span data-ttu-id="a1e95-149">ASP.NET Core 2,0 değişiklikleri, uygulamanızı çalıştırırken Visual Studio tarafından kullanılan çalışma `dotnet ef` diziniyle hizalamak için tarafından kullanılan çalışma dizinini de gerektirir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-149">The ASP.NET Core 2.0 changes also required the working directory used by `dotnet ef` to align with the working directory used by Visual Studio when running your application.</span></span> <span data-ttu-id="a1e95-150">Bunun bir observable yan etkisi, SQLite dosya adlarının artık proje dizinine göre ve bu şekilde kullanıldıkları gibi çıkış dizinine göre değil.</span><span class="sxs-lookup"><span data-stu-id="a1e95-150">One observable side effect of this is that SQLite filenames are now relative to the project directory and not the output directory like they used to be.</span></span>

## <a name="ef-core-20-requires-a-20-database-provider"></a><span data-ttu-id="a1e95-151">EF Core 2,0, 2,0 veritabanı sağlayıcısı gerektiriyor</span><span class="sxs-lookup"><span data-stu-id="a1e95-151">EF Core 2.0 requires a 2.0 database provider</span></span>

<span data-ttu-id="a1e95-152">EF Core 2,0 için, veritabanı sağlayıcılarının çalışması sırasında birçok basitleştirme ve geliştirme yaptık.</span><span class="sxs-lookup"><span data-stu-id="a1e95-152">For EF Core 2.0 we have made many simplifications and improvements in the way database providers work.</span></span> <span data-ttu-id="a1e95-153">Bu, 1.0. x ve 1.1. x sağlayıcılarının EF Core 2,0 ile çalışmayacağı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-153">This means that 1.0.x and 1.1.x providers will not work with EF Core 2.0.</span></span>

<span data-ttu-id="a1e95-154">SQL Server ve SQLite sağlayıcıları EF ekibi tarafından sevk edilir ve 2,0 sürümleri 2,0 sürümünün bir parçası olarak sunulacaktır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-154">The SQL Server and SQLite providers are shipped by the EF team and 2.0 versions will be available as part of the 2.0 release.</span></span> <span data-ttu-id="a1e95-155">[SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL)ve [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) için açık kaynaklı üçüncü taraf sağlayıcıları 2,0 için güncelleştiriliyor.</span><span class="sxs-lookup"><span data-stu-id="a1e95-155">The open-source third party providers for [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), and [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) are being updated for 2.0.</span></span> <span data-ttu-id="a1e95-156">Diğer tüm sağlayıcılar için lütfen sağlayıcı yazıcı ile iletişime geçin.</span><span class="sxs-lookup"><span data-stu-id="a1e95-156">For all other providers, please contact the provider writer.</span></span>

## <a name="logging-and-diagnostics-events-have-changed"></a><span data-ttu-id="a1e95-157">Günlüğe kaydetme ve tanılama olayları değişti</span><span class="sxs-lookup"><span data-stu-id="a1e95-157">Logging and Diagnostics events have changed</span></span>

<span data-ttu-id="a1e95-158">Not: Bu değişiklikler çoğu uygulama kodunu etkilememelidir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-158">Note: these changes should not impact most application code.</span></span>

<span data-ttu-id="a1e95-159">Bir [ILogger](https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.ilogger) 'a gönderilen iletiler Için olay kimlikleri 2,0 içinde değişmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-159">The event IDs for messages sent to an [ILogger](https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.ilogger) have changed in 2.0.</span></span> <span data-ttu-id="a1e95-160">Olay kimlikleri artık EF Core kod genelinde benzersizdir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-160">The event IDs are now unique across EF Core code.</span></span> <span data-ttu-id="a1e95-161">Bu iletiler artık, örneğin MVC gibi kullanılan yapılandırılmış günlük için standart kalıbı de izler.</span><span class="sxs-lookup"><span data-stu-id="a1e95-161">These messages now also follow the standard pattern for structured logging used by, for example, MVC.</span></span>

<span data-ttu-id="a1e95-162">Günlükçü kategorileri de değişmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-162">Logger categories have also changed.</span></span> <span data-ttu-id="a1e95-163">Artık [Dbloggercategory](https://github.com/aspnet/EntityFrameworkCore/blob/rel/2.0.0/src/EFCore/DbLoggerCategory.cs)aracılığıyla erişilen iyi bilinen bir kategori kümesi vardır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-163">There is now a well-known set of categories accessed through [DbLoggerCategory](https://github.com/aspnet/EntityFrameworkCore/blob/rel/2.0.0/src/EFCore/DbLoggerCategory.cs).</span></span>

<span data-ttu-id="a1e95-164">[Diagnosticsource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) olayları artık karşılık gelen `ILogger` iletilerle aynı olay kimliği adlarını kullanır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-164">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) events now use the same event ID names as the corresponding `ILogger` messages.</span></span> <span data-ttu-id="a1e95-165">Olay yükleri, [eventdata](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.eventdata)'dan türetilmiş tüm nominal türlerdir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-165">The event payloads are all nominal types derived from [EventData](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.eventdata).</span></span>

<span data-ttu-id="a1e95-166">Olay kimlikleri, yük türleri ve kategoriler [Coreeventıd](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.coreeventid) ve [Relationaleventıd](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.relationaleventid) sınıflarında belgelenmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-166">Event IDs, payload types, and categories are documented in the [CoreEventId](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.coreeventid) and the [RelationalEventId](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.relationaleventid) classes.</span></span>

<span data-ttu-id="a1e95-167">Kimlikler ayrıca Microsoft. EntityFrameworkCore. Infrastructure ' dan yeni Microsoft. EntityFrameworkCore. Diagnostics ad alanına de taşınmıştır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-167">IDs have also moved from Microsoft.EntityFrameworkCore.Infrastructure to the new Microsoft.EntityFrameworkCore.Diagnostics namespace.</span></span>

## <a name="ef-core-relational-metadata-api-changes"></a><span data-ttu-id="a1e95-168">EF Core ilişkisel meta veri API 'SI değişiklikleri</span><span class="sxs-lookup"><span data-stu-id="a1e95-168">EF Core relational metadata API changes</span></span>

<span data-ttu-id="a1e95-169">EF Core 2,0, artık kullanılan her farklı sağlayıcı için farklı bir [IModel](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.imodel) oluşturacak.</span><span class="sxs-lookup"><span data-stu-id="a1e95-169">EF Core 2.0 will now build a different [IModel](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.imodel) for each different provider being used.</span></span> <span data-ttu-id="a1e95-170">Bu genellikle uygulama için saydamdır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-170">This is usually transparent to the application.</span></span> <span data-ttu-id="a1e95-171">Bu, alt düzey meta veri API 'lerinin basitleştirdiğini, _ortak ilişkisel meta veri kavramlarının_ her zaman `.Relational` `.SqlServer`, `.Sqlite`, vb. bir çağrısıyla yapılan bir çağrı aracılığıyla yapılması için kolaylaştırmıştır. Örneğin, 1.1. x kodu şöyle:</span><span class="sxs-lookup"><span data-stu-id="a1e95-171">This has facilitated a simplification of lower-level metadata APIs such that any access to _common relational metadata concepts_ is always made through a call to `.Relational` instead of `.SqlServer`, `.Sqlite`, etc. For example, 1.1.x code like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).SqlServer().TableName;
```

<span data-ttu-id="a1e95-172">Şu şekilde yazılmış olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="a1e95-172">Should now be written like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).Relational().TableName;
```

<span data-ttu-id="a1e95-173">Uzantı yöntemleri, gibi `ForSqlServerToTable`yöntemleri kullanmak yerine artık kullanımda olan geçerli sağlayıcıyı temel alarak koşullu kod yazmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-173">Instead of using methods like `ForSqlServerToTable`, extension methods are now available to write conditional code based on the current provider in use.</span></span> <span data-ttu-id="a1e95-174">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="a1e95-174">For example:</span></span>

```C#
modelBuilder.Entity<User>().ToTable(
    Database.IsSqlServer() ? "SqlServerName" : "OtherName");
```

<span data-ttu-id="a1e95-175">Bu değişikliğin yalnızca _Tüm_ ilişkisel sağlayıcılar Için tanımlanan API 'ler/meta veriler için geçerli olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="a1e95-175">Note that this change only applies to APIs/metadata that is defined for _all_ relational providers.</span></span> <span data-ttu-id="a1e95-176">API ve meta veriler yalnızca tek bir sağlayıcıya özgü olduğunda aynı kalır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-176">The API and metadata remains the same when it is specific to only a single provider.</span></span> <span data-ttu-id="a1e95-177">Örneğin, kümelenmiş dizinler SQL Server 'a özgüdür, bu nedenle `ForSqlServerIsClustered` `.SqlServer().IsClustered()` yine de kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-177">For example, clustered indexes are specific to SQL Sever, so `ForSqlServerIsClustered` and  `.SqlServer().IsClustered()` must still be used.</span></span>

## <a name="dont-take-control-of-the-ef-service-provider"></a><span data-ttu-id="a1e95-178">EF hizmeti sağlayıcısı denetimi yapmayın</span><span class="sxs-lookup"><span data-stu-id="a1e95-178">Don’t take control of the EF service provider</span></span>

<span data-ttu-id="a1e95-179">EF Core iç uygulama için `IServiceProvider` bir iç (bağımlılık ekleme kapsayıcısı) kullanır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-179">EF Core uses an internal `IServiceProvider` (a dependency injection container) for its internal implementation.</span></span> <span data-ttu-id="a1e95-180">Uygulamalar, EF Core özel durumlar dışında bu sağlayıcıyı oluşturmasına ve yönetmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-180">Applications should allow EF Core to create and manage this provider except in special cases.</span></span> <span data-ttu-id="a1e95-181">Tüm çağrıları kaldırmayı kesin olarak `UseInternalServiceProvider`düşünün.</span><span class="sxs-lookup"><span data-stu-id="a1e95-181">Strongly consider removing any calls to `UseInternalServiceProvider`.</span></span> <span data-ttu-id="a1e95-182">Bir uygulamanın çağrı `UseInternalServiceProvider`yapması gerekiyorsa, senaryonuzu işlemenin diğer yollarını araştırabilmemiz için lütfen [bir sorunu](https://github.com/aspnet/EntityFramework/Issues) yerleştirmeyi düşünün.</span><span class="sxs-lookup"><span data-stu-id="a1e95-182">If an application does need to call `UseInternalServiceProvider`, then please consider [filing an issue](https://github.com/aspnet/EntityFramework/Issues) so we can investigate other ways to handle your scenario.</span></span>

<span data-ttu-id="a1e95-183">Çağırılmadan, `AddEntityFramework` `UseInternalServiceProvider` , vb. çağırma uygulama kodu için gerekli değildir. `AddEntityFrameworkSqlServer`</span><span class="sxs-lookup"><span data-stu-id="a1e95-183">Calling `AddEntityFramework`, `AddEntityFrameworkSqlServer`, etc. is not required by application code unless `UseInternalServiceProvider` is also called.</span></span> <span data-ttu-id="a1e95-184">Ya `AddDbContext` `AddEntityFramework` da'ayönelikmevcutçağrıların,dahaönceileaynışekildekullanılmasıgerekir.`AddEntityFrameworkSqlServer`</span><span class="sxs-lookup"><span data-stu-id="a1e95-184">Remove any existing calls to `AddEntityFramework` or `AddEntityFrameworkSqlServer`, etc. `AddDbContext` should still be used in the same way as before.</span></span>

## <a name="in-memory-databases-must-be-named"></a><span data-ttu-id="a1e95-185">Bellek içi veritabanlarının adlandırılması gerekir</span><span class="sxs-lookup"><span data-stu-id="a1e95-185">In-memory databases must be named</span></span>

<span data-ttu-id="a1e95-186">Genel adlandırılmamış bellek içi veritabanı kaldırılmıştır ve bunun yerine tüm bellek içi veritabanlarının adlandırılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-186">The global unnamed in-memory database has been removed and instead all in-memory databases must be named.</span></span> <span data-ttu-id="a1e95-187">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="a1e95-187">For example:</span></span>

``` csharp
optionsBuilder.UseInMemoryDatabase("MyDatabase");
```

<span data-ttu-id="a1e95-188">Bu, "MyDatabase" adlı bir veritabanını oluşturur/kullanır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-188">This creates/uses a database with the name “MyDatabase”.</span></span> <span data-ttu-id="a1e95-189">`UseInMemoryDatabase` Aynı adla yeniden çağrılırsa, aynı bellek içi veritabanı kullanılır ve bu da birden çok bağlam örneği tarafından paylaşılmak üzere olur.</span><span class="sxs-lookup"><span data-stu-id="a1e95-189">If `UseInMemoryDatabase` is called again with the same name, then the same in-memory database will be used, allowing it to be shared by multiple context instances.</span></span>

## <a name="read-only-api-changes"></a><span data-ttu-id="a1e95-190">Salt okunurdur API değişiklikleri</span><span class="sxs-lookup"><span data-stu-id="a1e95-190">Read-only API changes</span></span>

<span data-ttu-id="a1e95-191">`IsReadOnlyBeforeSave`, `IsReadOnlyAfterSave`, ve `IsStoreGeneratedAlways` kullanımdan kaldırılmıştır ve [beforesavebehavior](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.iproperty.beforesavebehavior) ve [aftersavebehavior](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.iproperty.aftersavebehavior)ile değiştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-191">`IsReadOnlyBeforeSave`, `IsReadOnlyAfterSave`, and `IsStoreGeneratedAlways` have been obsoleted and replaced with [BeforeSaveBehavior](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.iproperty.beforesavebehavior) and [AfterSaveBehavior](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.iproperty.aftersavebehavior).</span></span> <span data-ttu-id="a1e95-192">Bu davranışlar her özellik için geçerlidir (yalnızca depo tarafından üretilen Özellikler değil) ve bir veritabanı satırına (`BeforeSaveBehavior`) eklenirken veya var olan bir veritabanı`AfterSaveBehavior`satırı () güncelleştirilirken özelliğin değerinin nasıl kullanılacağı belirlenir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-192">These behaviors apply to any property (not only store-generated properties) and determine how the value of the property should be used when inserting into a database row (`BeforeSaveBehavior`) or when updating an existing database row (`AfterSaveBehavior`).</span></span>

<span data-ttu-id="a1e95-193">[Valuegenerated. OnAddOrUpdate](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.valuegenerated) (örneğin, hesaplanan sütunlar için) olarak işaretlenen özellikler, varsayılan olarak, özelliğinde ayarlanmış olan tüm değerleri yoksayar.</span><span class="sxs-lookup"><span data-stu-id="a1e95-193">Properties marked as [ValueGenerated.OnAddOrUpdate](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.metadata.valuegenerated) (for example, for computed columns) will by default ignore any value currently set on the property.</span></span> <span data-ttu-id="a1e95-194">Bu, izlenen varlık üzerinde herhangi bir değerin ayarlanmış veya değiştirilmiş olmasından bağımsız olarak her zaman bir mağaza tarafından oluşturulan değerin elde edilmeyeceği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-194">This means that a store-generated value will always be obtained regardless of whether any value has been set or modified on the tracked entity.</span></span> <span data-ttu-id="a1e95-195">Bu, farklı `Before\AfterSaveBehavior`ayarlanarak değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-195">This can be changed by setting a different `Before\AfterSaveBehavior`.</span></span>

## <a name="new-clientsetnull-delete-behavior"></a><span data-ttu-id="a1e95-196">Yeni ClientSetNull silme davranışı</span><span class="sxs-lookup"><span data-stu-id="a1e95-196">New ClientSetNull delete behavior</span></span>

<span data-ttu-id="a1e95-197">Önceki sürümlerde, [DeleteBehavior. restrict](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.deletebehavior) bağlam tarafından izlenen varlıklar için daha fazla eşleşen `SetNull` semantiğini daha fazla kapatan bir davranışa sahipti.</span><span class="sxs-lookup"><span data-stu-id="a1e95-197">In previous releases, [DeleteBehavior.Restrict](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.deletebehavior) had a behavior for entities tracked by the context that more closed matched `SetNull` semantics.</span></span> <span data-ttu-id="a1e95-198">EF Core 2,0 ' de, isteğe `ClientSetNull` bağlı ilişkiler için varsayılan olarak yeni bir davranış sunulmuştur.</span><span class="sxs-lookup"><span data-stu-id="a1e95-198">In EF Core 2.0, a new `ClientSetNull` behavior has been introduced as the default for optional relationships.</span></span> <span data-ttu-id="a1e95-199">Bu davranışın, `SetNull` EF Core kullanılarak oluşturulan veritabanlarının izlenen `Restrict` varlıkları ve davranışları için semantiği vardır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-199">This behavior has `SetNull` semantics for tracked entities and `Restrict` behavior for databases created using EF Core.</span></span> <span data-ttu-id="a1e95-200">Deneyimimizde, izlenen varlıklar ve veritabanı için en çok beklenen/kullanışlı davranışlar vardır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-200">In our experience, these are the most expected/useful behaviors for tracked entities and the database.</span></span> <span data-ttu-id="a1e95-201">`DeleteBehavior.Restrict`, isteğe bağlı ilişkiler için ayarlandığında, izlenen varlıklar için artık kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-201">`DeleteBehavior.Restrict` is now honored for tracked entities when set for optional relationships.</span></span>

## <a name="provider-design-time-packages-removed"></a><span data-ttu-id="a1e95-202">Sağlayıcı tasarım-zaman paketleri kaldırıldı</span><span class="sxs-lookup"><span data-stu-id="a1e95-202">Provider design-time packages removed</span></span>

<span data-ttu-id="a1e95-203">`Microsoft.EntityFrameworkCore.Relational.Design` Paket kaldırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="a1e95-203">The `Microsoft.EntityFrameworkCore.Relational.Design` package has been removed.</span></span> <span data-ttu-id="a1e95-204">İçeriği `Microsoft.EntityFrameworkCore.Relational` ve ile `Microsoft.EntityFrameworkCore.Design`birleştirildi.</span><span class="sxs-lookup"><span data-stu-id="a1e95-204">It's contents were consolidated into `Microsoft.EntityFrameworkCore.Relational` and `Microsoft.EntityFrameworkCore.Design`.</span></span>

<span data-ttu-id="a1e95-205">Bu, sağlayıcı tasarım zamanı paketlerine yayar.</span><span class="sxs-lookup"><span data-stu-id="a1e95-205">This propagates into the provider design-time packages.</span></span> <span data-ttu-id="a1e95-206">Bu paketler (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, vb.) kaldırılmıştır ve içerikleri ana sağlayıcı paketlerine birleştirilir.</span><span class="sxs-lookup"><span data-stu-id="a1e95-206">Those packages (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, etc.) were removed and their contents consolidated into the main provider packages.</span></span>

<span data-ttu-id="a1e95-207">EF Core 2,0 `Scaffold-DbContext` ' `dotnet ef dbcontext scaffold` de etkinleştirmek için, yalnızca tek sağlayıcı paketine başvurmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="a1e95-207">To enable `Scaffold-DbContext` or `dotnet ef dbcontext scaffold` in EF Core 2.0, you only need to reference the single provider package:</span></span>

``` xml
<PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer"
    Version="2.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools"
    Version="2.0.0"
    PrivateAssets="All" />
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet"
    Version="2.0.0" />
```
