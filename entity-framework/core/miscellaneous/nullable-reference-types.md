---
title: Null yapılabilir başvuru türleriyle çalışma-EF Core
author: roji
ms.date: 09/09/2019
ms.assetid: bde4e0ee-fba3-4813-a849-27049323d301
uid: core/miscellaneous/nullable-reference-types
ms.openlocfilehash: c16a475c363320cd18804a4efe78ccae1ae22f0d
ms.sourcegitcommit: cc0ff36e46e9ed3527638f7208000e8521faef2e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78416657"
---
# <a name="working-with-nullable-reference-types"></a><span data-ttu-id="8b00a-102">Null yapılabilir başvuru türleriyle çalışma</span><span class="sxs-lookup"><span data-stu-id="8b00a-102">Working with Nullable Reference Types</span></span>

<span data-ttu-id="8b00a-103">C#8 null [yapılabilir başvuru türleri](/dotnet/csharp/tutorials/nullable-reference-types)adlı yeni bir özellik tanıtılan ve başvuru türlerine açıklama eklenip eklenmeyeceğini belirten, bunların null içermesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="8b00a-103">C# 8 introduced a new feature called [nullable reference types](/dotnet/csharp/tutorials/nullable-reference-types), allowing reference types to be annotated, indicating whether it is valid for them to contain null or not.</span></span> <span data-ttu-id="8b00a-104">Bu özellik için yeni bir özelliktir, C# belgeleri okuyarak bunu öğrenmeniz önerilir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-104">If you are new to this feature, it is recommended that make yourself familiar with it by reading the C# docs.</span></span>

<span data-ttu-id="8b00a-105">Bu sayfa, EF Core null yapılabilir başvuru türleri desteğini tanıtır ve bunlarla çalışmak için en iyi yöntemleri açıklar.</span><span class="sxs-lookup"><span data-stu-id="8b00a-105">This page introduces EF Core's support for nullable reference types, and describes best practices for working with them.</span></span>

## <a name="required-and-optional-properties"></a><span data-ttu-id="8b00a-106">Gerekli ve isteğe bağlı özellikler</span><span class="sxs-lookup"><span data-stu-id="8b00a-106">Required and optional properties</span></span>

<span data-ttu-id="8b00a-107">Gerekli ve isteğe bağlı özellikler hakkındaki ana belgeler ve bunların null yapılabilir başvuru türleriyle etkileşimi, [gerekli ve Isteğe bağlı özellikler](xref:core/modeling/entity-properties#required-and-optional-properties) sayfasıdır.</span><span class="sxs-lookup"><span data-stu-id="8b00a-107">The main documentation on required and optional properties and their interaction with nullable reference types is the [Required and Optional Properties](xref:core/modeling/entity-properties#required-and-optional-properties) page.</span></span> <span data-ttu-id="8b00a-108">Önce bu sayfayı okuyarak başlatmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-108">It is recommended you start out by reading that page first.</span></span>

> [!NOTE]
> <span data-ttu-id="8b00a-109">Mevcut bir projede null yapılabilir başvuru türlerini etkinleştirirken dikkatli olun: daha önce isteğe bağlı olarak yapılandırılmış olan başvuru türü özellikleri, açıkça null olarak açıklanmadığı sürece artık gerekli olarak yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="8b00a-109">Exercise caution when enabling nullable reference types on an existing project: reference type properties which were previously configured as optional will now be configured as required, unless they are explicitly annotated to be nullable.</span></span> <span data-ttu-id="8b00a-110">İlişkisel bir veritabanı şemasını yönetirken, bu, veritabanı sütununun null değer alabilme durumu belirleyen geçişlerin oluşturulmasına neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-110">When managing a relational database schema, this may cause migrations to be generated which alter the database column's nullability.</span></span>

## <a name="dbcontext-and-dbset"></a><span data-ttu-id="8b00a-111">DbContext ve DbSet</span><span class="sxs-lookup"><span data-stu-id="8b00a-111">DbContext and DbSet</span></span>

<span data-ttu-id="8b00a-112">Null yapılabilir başvuru türleri etkinleştirildiğinde, C# derleyici null değer içereceklerde hiçbir başlatılmamış null yapılamayan özelliği için uyarı yayar.</span><span class="sxs-lookup"><span data-stu-id="8b00a-112">When nullable reference types are enabled, the C# compiler emits warnings for any uninitialized non-nullable property, as these would contain null.</span></span> <span data-ttu-id="8b00a-113">Sonuç olarak, bir bağlamda null yapılamayan `DbSet` tanımlamanın ortak yöntemi artık bir uyarı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="8b00a-113">As a result, the common practice of defining a non-nullable `DbSet` on a context will now generate a warning.</span></span> <span data-ttu-id="8b00a-114">Ancak, EF Core her zaman DbContext ile türetilmiş türler üzerinde tüm `DbSet` özelliklerini başlatır, bu nedenle derleyici bunun farkında olmasa bile hiçbir zaman null olmamaları garanti edilir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-114">However, EF Core always initializes all `DbSet` properties on DbContext-derived types, so they are guaranteed to never be null, even if the compiler is unaware of this.</span></span> <span data-ttu-id="8b00a-115">Bu nedenle, `DbSet` özelliklerinin null yapılamayan olarak tutulması önerilir. bu sayede, null denetimleri olmadan bunlara erişip onları null olarak ayarlayarak derleyici uyarılarını da null olarak ayarlayarak boş olarak ayarlayabilirsiniz (!):</span><span class="sxs-lookup"><span data-stu-id="8b00a-115">Therefore, it is recommended to keep your `DbSet` properties non-nullable - allowing you to access them without null checks - and to silence the compiler warnings by explicitly setting them to null with the help of the null-forgiving operator (!):</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/NullableReferenceTypes/NullableReferenceTypesContext.cs?name=Context&highlight=3-4)]

## <a name="non-nullable-properties-and-initialization"></a><span data-ttu-id="8b00a-116">Null yapılamayan Özellikler ve başlatma</span><span class="sxs-lookup"><span data-stu-id="8b00a-116">Non-nullable properties and initialization</span></span>

<span data-ttu-id="8b00a-117">Başlatılmamış null yapılamayan başvuru türleri için derleyici uyarıları ayrıca varlık türlerinizin normal özellikleri için bir sorundur.</span><span class="sxs-lookup"><span data-stu-id="8b00a-117">Compiler warnings for uninitialized non-nullable reference types are also a problem for regular properties on your entity types.</span></span> <span data-ttu-id="8b00a-118">Yukarıdaki örnekte, null olamayan özelliklerle sorunsuz bir şekilde çalışacak, bu uyarıların her zaman başlatılmış olduğundan emin olmak için [Oluşturucu bağlamayı](xref:core/modeling/constructors)kullanarak bu uyarıları önliyoruz.</span><span class="sxs-lookup"><span data-stu-id="8b00a-118">In our example above, we avoided these warnings by using [constructor binding](xref:core/modeling/constructors), a feature which works perfectly with non-nullable properties, ensuring they are always initialized.</span></span> <span data-ttu-id="8b00a-119">Ancak, bazı senaryolarda Oluşturucu bağlamasında bir seçenek olmaz: gezinti özellikleri, örneğin, bu şekilde başlatılamaz.</span><span class="sxs-lookup"><span data-stu-id="8b00a-119">However, in some scenarios constructor binding isn't an option: navigation properties, for example, cannot be initialized in this way.</span></span>

<span data-ttu-id="8b00a-120">Gerekli gezinti özellikleri ek bir zorluk sunsun: belirli bir sorumlu için her zaman bağımlı bir değere sahip olsa da, programda o noktadaki gereksinimlere bağlı olarak belirli bir sorgu tarafından yüklenemeyebilir veya yüklenmeyebilir ([bkz. veri yükleme için farklı desenler](xref:core/querying/related-data)).</span><span class="sxs-lookup"><span data-stu-id="8b00a-120">Required navigation properties present an additional difficulty: although a dependent will always exist for a given principal, it may or may not be loaded by a particular query, depending on the needs at that point in the program ([see the different patterns for loading data](xref:core/querying/related-data)).</span></span> <span data-ttu-id="8b00a-121">Aynı zamanda, gerekli olsa bile, bu özelliklerin null olup olmadığını denetlemek için tüm erişimleri zorlamadıklarından, bu özellikleri null yapılabilir hale getirmek de mümkün değildir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-121">At the same time, it is undesirable to make these properties nullable, since that would force all access to them to check for null, even if they are required.</span></span>

<span data-ttu-id="8b00a-122">Bu senaryolarla başa çıkmak için bir yol, null yapılabilir bir [yedekleme alanı](xref:core/modeling/backing-field)olan null atanamaz bir özelliğe sahiptir:</span><span class="sxs-lookup"><span data-stu-id="8b00a-122">One way to deal with these scenarios, is to have a non-nullable property with a nullable [backing field](xref:core/modeling/backing-field):</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/NullableReferenceTypes/Order.cs?range=10-17)]

<span data-ttu-id="8b00a-123">Gezinti özelliği null değer atanamaz olduğundan, gerekli bir gezinti yapılandırılır; gezinti düzgün şekilde yüklendiği sürece, bağımlı olacaktır, özelliği aracılığıyla erişilebilir olur.</span><span class="sxs-lookup"><span data-stu-id="8b00a-123">Since the navigation property is non-nullable, a required navigation is configured; and as long as the navigation is properly loaded, the dependent will be accessible via the property.</span></span> <span data-ttu-id="8b00a-124">Ancak, özellikle ilgili varlığı doğru şekilde yüklemeden özelliğe erişildiğinde, API sözleşmesi yanlış kullanıldığı için bir InvalidOperationException atılır.</span><span class="sxs-lookup"><span data-stu-id="8b00a-124">If, however, the property is accessed without first properly loading the related entity, an InvalidOperationException is thrown, since the API contract has been used incorrectly.</span></span> <span data-ttu-id="8b00a-125">Değer, ayarlanmadığında bile değeri okuyabildiğine bağlı olarak, özelliği değil, her zaman yedekleme alanına erişecek şekilde yapılandırılmalıdır. Bunun nasıl yapılacağı hakkındaki [alanları](xref:core/modeling/backing-field) ve yapılandırmanın doğru olduğundan emin olmak için `PropertyAccessMode.Field` belirtmeyi göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="8b00a-125">Note that EF must be configured to always access the backing field and not the property, as it relies on being able to read the value even when unset; consult the documentation on [backing fields](xref:core/modeling/backing-field) on how to do this, and consider specifying `PropertyAccessMode.Field` to make sure the configuration is correct.</span></span>

<span data-ttu-id="8b00a-126">Bir Terme alternatifi olarak, null-forverme işlecinin (!) yardımı ile özelliği null olarak başlatmak mümkündür:</span><span class="sxs-lookup"><span data-stu-id="8b00a-126">As a terser alternative, it is possible to simply initialize the property to null with the help of the null-forgiving operator (!):</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/NullableReferenceTypes/Order.cs?range=19)]

<span data-ttu-id="8b00a-127">Bir programlama hatasının sonucu haricinde gerçek bir null değer hiçbir zaman gözlemlenmeyecektir, örn. ilgili varlığı önceden düzgün şekilde yüklemeden gezinti özelliğine erişim.</span><span class="sxs-lookup"><span data-stu-id="8b00a-127">An actual null value will never be observed except as a result of a programming bug, e.g. accessing the navigation property without properly loading the related entity beforehand.</span></span>

> [!NOTE]
> <span data-ttu-id="8b00a-128">Birden çok ilgili varlığa başvurular içeren koleksiyon gezginlerinin her zaman null değer atanamaz olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-128">Collection navigations, which contain references to multiple related entities, should always be non-nullable.</span></span> <span data-ttu-id="8b00a-129">Boş bir koleksiyon, ilgili hiçbir varlık olmadığı anlamına gelir, ancak listenin kendisi hiçbir şekilde null olmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="8b00a-129">An empty collection means that no related entities exist, but the list itself should never be null.</span></span>

## <a name="navigating-and-including-nullable-relationships"></a><span data-ttu-id="8b00a-130">Null yapılabilir ilişkiler dahil ve gezinme</span><span class="sxs-lookup"><span data-stu-id="8b00a-130">Navigating and including nullable relationships</span></span>

<span data-ttu-id="8b00a-131">İsteğe bağlı ilişkilerle ilgilenirken, gerçek bir null başvuru özel durumunun imkansız olacağı Derleyici uyarıları ile karşılaşmak mümkündür.</span><span class="sxs-lookup"><span data-stu-id="8b00a-131">When dealing with optional relationships, it's possible to encounter compiler warnings where an actual null reference exception would be impossible.</span></span> <span data-ttu-id="8b00a-132">LINQ EF Core sorgularınızı çevirirken ve yürütürken, isteğe bağlı bir ilgili varlık yoksa, bunun için herhangi bir gezinti yapmak yerine yalnızca yok sayılacak olur.</span><span class="sxs-lookup"><span data-stu-id="8b00a-132">When translating and executing your LINQ queries, EF Core guarantees that if an optional related entity does not exist, any navigation to it will simply be ignored, rather than throwing.</span></span> <span data-ttu-id="8b00a-133">Ancak, derleyici bu EF Core garantisi hakkında farkında değildir ve LINQ sorgusu bellekte yürütülürse, LINQ to Objects birlikte uyarılar üretir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-133">However, the compiler is unaware of this EF Core guarantee, and produces warnings as if the LINQ query were executed in memory, with LINQ to Objects.</span></span> <span data-ttu-id="8b00a-134">Sonuç olarak, derleyiciye gerçek bir null değerin mümkün olmadığını bildirmek için null-forverme işlecinin (!) kullanılması gerekir:</span><span class="sxs-lookup"><span data-stu-id="8b00a-134">As a result, it is necessary to use the null-forgiving operator (!) to inform the compiler that an actual null value isn't possible:</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/NullableReferenceTypes/Program.cs?range=46)]

<span data-ttu-id="8b00a-135">İsteğe bağlı gezinmeler arasında birden çok ilişki düzeyi dahil edildiğinde de benzer bir sorun oluşur:</span><span class="sxs-lookup"><span data-stu-id="8b00a-135">A similar issue occurs when including multiple levels of relationships across optional navigations:</span></span>

[!code-csharp[Main](../../../samples/core/Miscellaneous/NullableReferenceTypes/Program.cs?range=36-39&highlight=2)]

<span data-ttu-id="8b00a-136">Bunu çok fazla fark ederseniz ve söz konusu varlık türleri EF Core sorgularda kullanılan ağırlıklı (veya özel olarak) ise, gezinti özelliklerini null değer atanamaz hale getirmeyi ve bunları akıcı API veya veri ek açıklamaları aracılığıyla isteğe bağlı olarak yapılandırmayı düşünün.</span><span class="sxs-lookup"><span data-stu-id="8b00a-136">If you find yourself doing this a lot, and the entity types in question are predominantly (or exclusively) used in EF Core queries, consider making the navigation properties non-nullable, and to configure them as optional via the Fluent API or Data Annotations.</span></span> <span data-ttu-id="8b00a-137">Bu, ilişkiyi isteğe bağlı tutarken tüm derleyici uyarılarını kaldırır; Ancak, varlıklarınız EF Core dışına çıkardığında, Özellikler null değer atanamaz olarak açıklansa da null değerler gözlemleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8b00a-137">This will remove all compiler warnings while keeping the relationship optional; however, if your entities are traversed outside of EF Core, you may observe null values although the properties are annotated as non-nullable.</span></span>

## <a name="limitations"></a><span data-ttu-id="8b00a-138">Sınırlamalar</span><span class="sxs-lookup"><span data-stu-id="8b00a-138">Limitations</span></span>

* <span data-ttu-id="8b00a-139">Ters mühendislik Şu anda [ C# 8 Nullable başvuru türünü (nrts)](/dotnet/csharp/tutorials/nullable-reference-types)desteklememektedir: EF Core her zaman özelliğin C# kapalı olduğunu varsayan kodu üretir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-139">Reverse engineering does not currently support [C# 8 nullable reference types (NRTs)](/dotnet/csharp/tutorials/nullable-reference-types): EF Core always generates C# code that assumes the feature is off.</span></span> <span data-ttu-id="8b00a-140">Örneğin, null yapılabilir metin sütunları, bir özelliğin gerekli olup olmadığını yapılandırmak için kullanılan akıcı API veya veri ek açıklamalarıyla `string?`değil, `string` türü olan bir özellik olarak tanılanacaktır.</span><span class="sxs-lookup"><span data-stu-id="8b00a-140">For example, nullable text columns will be scaffolded as a property with type `string` , not `string?`, with either the Fluent API or Data Annotations used to configure whether a property is required or not.</span></span> <span data-ttu-id="8b00a-141">Yapı iskelesi kodunu düzenleyebilir ve bunları C# null yapılabilir ek açıklamalarla değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8b00a-141">You can edit the scaffolded code and replace these with C# nullability annotations.</span></span> <span data-ttu-id="8b00a-142">Null yapılabilir başvuru türleri için yapı iskelesi desteği [#15520](https://github.com/aspnet/EntityFrameworkCore/issues/15520)soruna göre izlenir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-142">Scaffolding support for nullable reference types is tracked by issue [#15520](https://github.com/aspnet/EntityFrameworkCore/issues/15520).</span></span>
* <span data-ttu-id="8b00a-143">EF Core genel API 'SI yüzeyi, null olabilme için henüz açıklanmamıştır (ortak API "null-yükümlülüğü"), bu, bazen NRT özelliği açık olduğunda daha fazla zaman alabilir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-143">EF Core's public API surface has not yet been annotated for nullability (the public API is "null-oblivious"), making it sometimes awkward to use when the NRT feature is turned on.</span></span> <span data-ttu-id="8b00a-144">Bu özellikle, [Firstordefaultasync](/dotnet/api/microsoft.entityframeworkcore.entityframeworkqueryableextensions.firstordefaultasync#Microsoft_EntityFrameworkCore_EntityFrameworkQueryableExtensions_FirstOrDefaultAsync__1_System_Linq_IQueryable___0__System_Linq_Expressions_Expression_System_Func___0_System_Boolean___System_Threading_CancellationToken_)gibi EF Core tarafından sunulan zaman uyumsuz LINQ işleçlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="8b00a-144">This notably includes the async LINQ operators exposed by EF Core, such as [FirstOrDefaultAsync](/dotnet/api/microsoft.entityframeworkcore.entityframeworkqueryableextensions.firstordefaultasync#Microsoft_EntityFrameworkCore_EntityFrameworkQueryableExtensions_FirstOrDefaultAsync__1_System_Linq_IQueryable___0__System_Linq_Expressions_Expression_System_Func___0_System_Boolean___System_Threading_CancellationToken_).</span></span> <span data-ttu-id="8b00a-145">Bu 5,0 sürümü için bu adresi ele almak için planlıyoruz.</span><span class="sxs-lookup"><span data-stu-id="8b00a-145">We plan to address this for the 5.0 release.</span></span>
